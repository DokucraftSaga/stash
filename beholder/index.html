<!DOCTYPE html><html><head><script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/108/three.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.2/jszip.min.js"></script><style>* {
  margin: 0;
  padding: 0;
}
body {
  background: #000;
  overflow: hidden;
  width: 100%;
  height: 100%;
}
canvas {
  opacity: 0;
  transition: opacity 2.5s;
}
#loading-hint {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: Consolas,monospace;
  color: #999999;
  font-size: 72px;
  opacity: 1;
  transition: opacity 2s;
  pointer-events: none;
  cursor: default;
  user-select: none;
}</style></head><body><div id="loading-hint">Loading...</div><script>THREE.PointerLockControls=function(t,e){function o(e){if(!1!==r.isLocked){var o=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;u.setFromQuaternion(t.quaternion),u.y-=.002*o,u.x-=.002*n,u.x=Math.max(-d,Math.min(d,u.x)),t.quaternion.setFromEuler(u),r.dispatchEvent(c)}}function n(){document.pointerLockElement===r.domElement?(r.dispatchEvent(s),r.isLocked=!0):(r.dispatchEvent(m),r.isLocked=!1)}function i(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.domElement=e||document.body,this.isLocked=!1;var r=this,c={type:"change"},s={type:"lock"},m={type:"unlock"},u=new THREE.Euler(0,0,0,"YXZ"),d=Math.PI/2,a=new THREE.Vector3;this.connect=function(){document.addEventListener("mousemove",o,!1),document.addEventListener("pointerlockchange",n,!1),document.addEventListener("pointerlockerror",i,!1)},this.disconnect=function(){document.removeEventListener("mousemove",o,!1),document.removeEventListener("pointerlockchange",n,!1),document.removeEventListener("pointerlockerror",i,!1)},this.dispose=function(){this.disconnect()},this.getObject=function(){return t},this.getDirection=function(){var e=new THREE.Vector3(0,0,-1);return function(o){return o.copy(e).applyQuaternion(t.quaternion)}}(),this.moveForward=function(e){a.setFromMatrixColumn(t.matrix,0),a.crossVectors(t.up,a),t.position.addScaledVector(a,e)},this.moveRight=function(e){a.setFromMatrixColumn(t.matrix,0),t.position.addScaledVector(a,e)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){document.exitPointerLock()},this.connect()},THREE.PointerLockControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.PointerLockControls.prototype.constructor=THREE.PointerLockControls;</script><script>function getURLParams(e=location.search){if(e.length<2)return null;let n={};const a=/(?:^\?|&)([A-z0-9-]+)(?:=([^&]+)|(?=&)|$|=)/g;let t;for(;t=a.exec(e);)n[t[1]]=!t[2]||decodeURIComponent(t[2].replace(/\+/g,"%20"));return n}(async()=>{const e=new THREE.Scene,n=new THREE.PerspectiveCamera(85,window.innerWidth/window.innerHeight,.1,1e3),a=new THREE.PointerLockControls(n);e.add(a.getObject());const t=new THREE.Euler(0,0,0,"YXZ"),i=new THREE.WebGLRenderer;i.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(i.domElement),window.addEventListener("resize",()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)},!1);const o=getURLParams();if(null==o||!o.src)return void(document.getElementById("loading-hint").textContent="Nothing to display.");const r=()=>{function r(){requestAnimationFrame(r),i.render(e,n),a.enabled||(t.setFromQuaternion(n.quaternion),t.y+=.001,n.quaternion.setFromEuler(t))}i.domElement.style.opacity=1,document.getElementById("loading-hint").style.opacity=0,o.nocontrol||document.body.addEventListener("click",e=>{a.enabled?(a.unlock(),a.enabled=!1):(a.lock(),a.enabled=!0)},!1),r()};if("skybox"==o.format){const n=1/3+.001,a=2/3-.001,t=.499,i=.501,d=new THREE.BoxGeometry(1,1,1);d.faceVertexUvs=[[[{x:2/3,y:0},{x:2/3,y:t},{x:1,y:0}],[{x:2/3,y:t},{x:1,y:t},{x:1,y:0}],[{x:0,y:0},{x:0,y:t},{x:1/3,y:0}],[{x:0,y:t},{x:1/3,y:t},{x:1/3,y:0}],[{x:0,y:i},{x:0,y:1},{x:1/3,y:i}],[{x:0,y:1},{x:1/3,y:1},{x:1/3,y:i}],[{x:n,y:i},{x:n,y:1},{x:a,y:i}],[{x:n,y:1},{x:a,y:1},{x:a,y:i}],[{x:n,y:0},{x:n,y:t},{x:a,y:0}],[{x:n,y:t},{x:a,y:t},{x:a,y:0}],[{x:2/3,y:i},{x:2/3,y:1},{x:1,y:i}],[{x:2/3,y:1},{x:1,y:1},{x:1,y:i}]]];const s=(new THREE.TextureLoader).load(o.src);s.magFilter=THREE.LinearFilter,s.minFilter=THREE.LinearFilter;const y=new THREE.MeshBasicMaterial({side:THREE.BackSide,map:s}),c=new THREE.Mesh(d,y);e.add(c),c.scale.z=-1,c.scale.y=-1,r()}else if("panorama"==o.format){const n=await fetch("https://dokustash-cors.herokuapp.com/"+o.src);if(200!=n.status)throw new Error(n);const a=await JSZip.loadAsync(n.blob());e.background=(new THREE.CubeTextureLoader).load(["data:image/png;base64,"+await a.file("panorama_1.png").async("base64"),"data:image/png;base64,"+await a.file("panorama_3.png").async("base64"),"data:image/png;base64,"+await a.file("panorama_4.png").async("base64"),"data:image/png;base64,"+await a.file("panorama_5.png").async("base64"),"data:image/png;base64,"+await a.file("panorama_0.png").async("base64"),"data:image/png;base64,"+await a.file("panorama_2.png").async("base64")]),e.background.minFilter=THREE.LinearFilter,r()}else document.getElementById("loading-hint").textContent="Invalid format."})();</script></body></html>