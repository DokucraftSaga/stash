var MCAnimation=function(t,e){this.texture=new Image,this.texture.src=t,this.mcmeta=e||{},this.mcmeta=this.mcmeta.animation||this.mcmeta,this.canvas=document.createElement("canvas"),this.canvas.className="mc-animation",this.context=this.canvas.getContext("2d");let i=this;this.texture.onload=(()=>i.__onload())};MCAnimation.prototype.__onload=function(){this.frames=[],this.currentSubFrame=0;let t=this.mcmeta.hasOwnProperty("frametime")?this.mcmeta.frametime:1;if(this.mcmeta.hasOwnProperty("frames")){let e=this.mcmeta.frames;this.currentFrame="number"==typeof e[0]?e[0]:e[0].index;for(let i=0;i<e.length;i++)if("number"==typeof e[i])if(this.mcmeta.interpolate&&t>1){let s=[];for(let e=0;e<t;e++)s.push(e/t);let n=e.length>i+1?e[i+1]:e[0],a="number"==typeof n?n:n.index;this.frames.push({index:e[i],nextIndex:a,subFrames:s})}else this.frames.push({index:e[i],time:t});else if(this.mcmeta.interpolate&&e[i].time>1){let t=[];for(let s=0;s<e[i].time;s++)t.push(s/e[i].time);let s=e.length>i+1?e[i+1]:e[0],n="number"==typeof s?s:s.index;this.frames.push({index:e[i],nextIndex:n,subFrames:t})}else this.frames.push({index:e[i].index,time:e[i].time})}else{this.currentFrame=0;let e=this.texture.height/this.texture.width;for(let i=0;i<e;i++)if(this.mcmeta.interpolate&&t>1){let s=[];for(let e=0;e<t;e++)s.push(e/t);let n=e>i+1?i+1:0;this.frames.push({index:i,nextIndex:n,subFrames:s})}else this.frames.push({index:i,time:t})}"function"==typeof this.onload&&this.onload(),this.drawFrame()},MCAnimation.prototype.nextFrame=function(){this.currentFrame++,this.currentFrame>=this.frames.length&&(this.currentFrame=0),this.drawFrame()},MCAnimation.prototype.nextSubFrame=function(){this.frames[this.currentFrame].subFrames.length>this.currentSubFrame+1?(this.currentSubFrame=this.currentSubFrame+1,this.drawFrame()):(this.currentSubFrame=0,this.nextFrame())},MCAnimation.prototype.drawFrame=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.mozImageSmoothingEnabled=!1,this.context.msImageSmoothingEnabled=!1,this.context.imageSmoothingEnabled=!1;let t=this.frames[this.currentFrame];this.context.globalAlpha=1,this.context.drawImage(this.texture,0,this.texture.width*t.index,this.texture.width,this.texture.width,0,0,this.canvas.width,this.canvas.height);let e=this;t.subFrames?(this.context.globalAlpha=t.subFrames[this.currentSubFrame],this.context.drawImage(this.texture,0,this.texture.width*t.nextIndex,this.texture.width,this.texture.width,0,0,this.canvas.width,this.canvas.height),setTimeout(function(){window.requestAnimationFrame(function(){e.nextSubFrame()})},50)):(this.currentSubFrame=0,setTimeout(function(){window.requestAnimationFrame(function(){e.nextFrame()})},50*t.time))};