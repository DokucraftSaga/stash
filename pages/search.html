<div class="select-all svg-icon hidden"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M22,16A2,2 0 0,1 20,18H8C6.89,18 6,17.1 6,16V4C6,2.89 6.89,2 8,2H20A2,2 0 0,1 22,4V16M16,20V22H4A2,2 0 0,1 2,20V7H4V20H16M13,14L20,7L18.59,5.59L13,11.17L9.91,8.09L8.5,9.5L13,14Z" /></svg></div><div class="settings svg-icon hidden"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" /></svg></div><div class="chart svg-icon hidden"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M17.45,15.18L22,7.31V19L22,21H2V3H4V15.54L9.5,6L16,9.78L20.24,2.45L21.97,3.45L16.74,12.5L10.23,8.75L4.31,19H6.57L10.96,11.44L17.45,15.18Z" /></svg></div><link rel="stylesheet" href="/stash/pages/css/search.css"/><script>(()=>{function t(t){$("#content .file").css({width:128*t+"px",height:128*t+"px"}),t>1?$("#content").addClass("disable-thumbnails"):$("#content").removeClass("disable-thumbnails")}function e(t,e){let a=$(`#content .group[data-group="${e}"]`);0==a.length&&(a=E("div").addClass("group").append(E("h3").text(e)).attr("data-group",e),$("#content").append(a)),$(t).detach().appendTo(a)}function a(t,a,s){$("#content>.group>.result").detach().appendTo($("#content")),$("#content>.group").remove(),"none"!=t&&$("#content>.result").each((a,s)=>{const o=$(s).attr("data-file");if("category"==t){e(s,getCategory(o))}else if("contributor"==t){e(s,getContributor(o))}else if("year"==t){e(s,new Date(1e3*(stash.data[o].T||getApproxTime(getID(o)))).getFullYear())}else if("size"==t){const t=stash.data[o].S;e(s,stash.data[o].Z?"ZIP":t[1]>6*t[0]?"Animation Strips":t.join("x"))}else if("type"==t){const t="Image";if(stash.data[o].Z)t=stash.typeNames[stash.data[o].Z];else{const e=stash.data[o].S;(stash.data[o].M||e[1]/e[0]>=6&&e[1]%e[0]==0)&&(t="Animation")}e(s,t)}});const o=t=>{const e=t.children(".result").toArray().sort((t,e)=>{const s=$(t).attr("data-file"),o=$(e).attr("data-file");if("category"==a){const t=naturalSorter(getCategory(s),getCategory(o));return 0!=t?t:naturalSorter(s,o)}if("contributor"==a){const t=naturalSorter(getContributor(s),getContributor(o));return 0!=t?t:naturalSorter(s,o)}if("id"==a)return idSort(s,o);if("size"==a){const t=stash.data[s].S,e=stash.data[o].S,a=t[0]*t[1]-e[0]*e[1];return 0!=a?a:naturalSorter(s,o)}});"des"==s&&e.reverse(),t.append(e)};if("none"!=t){const e=$("#content>.group").toArray().sort((e,a)=>{const s=$(e).children("h3").text(),o=$(a).children("h3").text();if("size"==t){if("Animation Strips"==s||"ZIP"==s&&"Animation Strips"!=o)return-1;if("Animation Strips"==o||"ZIP"==o&&"Animation Strips"!=s)return 1;const t=s.split("x").map(t=>parseInt(t)),e=o.split("x").map(t=>parseInt(t));return t[0]*t[1]-e[0]*e[1]}return naturalSorter(s,o)});$("#content").append(e),$("#content>.group").each((t,e)=>{o($(e))})}else o($("#content"));updateResultGroupVisibility()}const s=decodeQuery(),o=stash.search(s);stash.page.onRemove=(()=>{$(".remove-on-page-change").remove(),$("#sorting-options").addClass("hidden")}),$("#title").after(E("h2").attr("id","results-count").addClass("remove-on-page-change"));const i=E("div").addClass("diamond-button-container").appendTo("#content"),n=stash.diamond.create(80).attr("id","display-options-button").attr("title","<h3>Display Options</h3><i>Scaling, grouping and sorting</i>").on("click",()=>{const e=stash.page.modal();e.find(".content").css("width","800px").append(E("h2").text("Display"),E("div").addClass("row").append(E("span").text("Scale:"),E("select").attr("id","display-scale").append(E("option").attr("value","1").html("1x<i> - 128x128 px</i>").prop("selected",1==stash.displayOptions.scale),E("option").attr("value","2").html("2x<i> - 256x256 px</i>").prop("selected",2==stash.displayOptions.scale),E("option").attr("value","3").html("3x<i> - 384x384 px</i>").prop("selected",3==stash.displayOptions.scale),E("option").attr("value","4").html("4x<i> - 512x512 px</i>").prop("selected",4==stash.displayOptions.scale))),E("h2").text("Grouping"),E("select").attr("id","display-grouping").append(E("option").attr("value","none").text("No groups").prop("selected","none"==stash.displayOptions.grouping),E("option").attr("value","category").text("Group by category").prop("selected","category"==stash.displayOptions.grouping),E("option").attr("value","contributor").text("Group by contributor").prop("selected","contributor"==stash.displayOptions.grouping),E("option").attr("value","year").text("Group by year").prop("selected","year"==stash.displayOptions.grouping),E("option").attr("value","size").text("Group by size").prop("selected","size"==stash.displayOptions.grouping),E("option").attr("value","type").text("Group by type").prop("selected","type"==stash.displayOptions.grouping)),E("h2").text("Sorting"),E("div").addClass("row").append(E("select").attr("id","display-sorting").append(E("option").attr("value","category").text("Sort by category").prop("selected","category"==stash.displayOptions.sorting),E("option").attr("value","contributor").text("Sort by contributor").prop("selected","contributor"==stash.displayOptions.sorting),E("option").attr("value","id").text("Sort by date").prop("selected","id"==stash.displayOptions.sorting),E("option").attr("value","size").text("Sort by size").prop("selected","size"==stash.displayOptions.sorting)),E("select").attr("id","display-order").append(E("option").attr("value","asc").text("Ascending order").prop("selected","asc"==stash.displayOptions.order),E("option").attr("value","des").text("Descending order").prop("selected","des"==stash.displayOptions.order))),E("br"),E("div").addClass("button inline").text("Done").on("click",s=>{stash.displayOptions={grouping:$("#display-grouping").val(),sorting:$("#display-sorting").val(),order:$("#display-order").val(),scale:parseInt($("#display-scale").val())},a(stash.displayOptions.grouping,stash.displayOptions.sorting,stash.displayOptions.order),t(stash.displayOptions.scale),stash.page.closeModal(e)}),E("div").addClass("button inline").text("Cancel").on("click",t=>stash.page.closeModal(e)),E("div").addClass("button inline").text("Reset").on("click",t=>{$("#display-grouping").val("none").selectric("refresh"),$("#display-sorting").val("id").selectric("refresh"),$("#display-order").val("des").selectric("refresh"),$("#display-scale").val("1").selectric("refresh")})),initSelectric()}).appendTo(i);n.find(".content").html($(".svg-icon.settings").html());const r=stash.diamond.create(80).attr("id","select-all-button").attr("title","<h3>Select All</h3><i>Right-click files to select them individually</i>").on("click",()=>stash.selectFiles($("#content .file:not(.hidden)").toArray().map(t=>$(t).attr("data-file")))).appendTo(i);r.find(".content").html($(".svg-icon.select-all").html());const l=stash.diamond.create(80).attr("id","show-stats-button").attr("title","<h3>Statistics</h3><i>Show statistics for the current search results</i>").on("click",()=>{stash.page.modal().find(".content").append(E("h2").text("Statistics"),stash.chart.timeline(o,{title:"Number of files over time",dataHandler:(t,e)=>t.map(t=>e[t].length).reduce((t,e)=>t.push((t.length&&t[t.length-1]||0)+e)&&t,[])},{title:"Files added per quarter",dataHandler:(t,e)=>t.map(t=>e[t].length)},{title:"Number of contributors",dataHandler:(t,e)=>t.map(t=>e[t].reduce((t,e)=>t.add(getContributor(e)),new Set)).map((t,e,a)=>a.slice(0,e+1).reduce((t,e)=>(e.forEach(e=>t.add(e)),t),new Set).size)},{title:"Active contributors per quarter",dataHandler:(t,e)=>t.map(t=>e[t].reduce((t,e)=>t.add(getContributor(e)),new Set).size)}))}).appendTo(i);l.find(".content").html($(".svg-icon.chart").html()),tippy([n[0],r[0],l[0]],{placement:"left",arrow:!0,animation:"perspective",dynamicTitle:!0}),setSearchFormVals(s.category,s.contributor,s.id,s.size,s.color),(e=>{if($("#content").children(":not(link,script,.svg-icon)"),0==e.length)return $("#content").append(E("div").addClass("hint").text("No results")),void $("#results-count").text("");if(e.length>2500)return $("#content").append(E("div").addClass("hint").text("Too many results (2500+), try narrowing your search")),void $("#results-count").text("");$("#results-count").text(`Results: ${e.length}`);for(let t=0;t<e.length;t++){let a=e[t],s=createFilePreview(a,E("div").addClass("result"));stash.selection.contains(a)&&s.addClass("selected"),s.on("click",()=>{goToPage(toURLParams({details:getID(a)}))}),s.on("contextmenu",t=>{stash.selection.contains(a)?stash.deselectFile(a):stash.selectFile(a),t.preventDefault(),t.stopPropagation()});let o=getID(a),i=stash.data[a].S;s.attr("title",`<h3>${getContributor(a)} #${o}</h3><br>`+(stash.data[a].Z?`Type: ${stash.typeNames[stash.data[a].Z]}<br>`:`Size: ${i[0]}x${i[1]}<br>`)+`Date: ${formatDate(stash.data[a].T||getApproxTime(o))}<br><br>`+`<i>${getCategory(a)}</i>`),tippy(s[0],{placement:"right",arrow:!0,animation:"perspective",performance:!0,delay:200}),$("#content").append(s)}$("#sorting-options").removeClass("hidden"),a(stash.displayOptions.grouping,stash.displayOptions.sorting,stash.displayOptions.order),t(stash.displayOptions.scale)})(o.sort(naturalSorter)),s.color&&filterResultsByColor()})();</script>