<div class="sp-search-wrapper"><div class="sidebar" style="opacity:0;"><div class="expand-button sidebar-button"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" /></svg><span>Collapse</span></div><div class="color-filter-button sidebar-button tt" title="&lt;h3&gt;Color Filter&lt;/h3&gt;&lt;i class=&quot;faded&quot;&gt;Filter results based on notable colors in the images&lt;/i&gt;"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z" /></svg><span>Color Filter</span></div><input class="color-picker-input hidden-input" type="text" value="#f00"/><div class="color-picker" style="opacity:0;"></div><div class="filler"></div><div class="result-count-wrapper tt" title="&lt;h3&gt;Result Count&lt;/h3&gt;&lt;i class=&quot;faded&quot;&gt;Number of files displayed&lt;/i&gt;"><div class="result-count">0</div><span class="result-count-text"> file</span></div><div class="select-all-button sidebar-button tt" title="&lt;h3&gt;Select All&lt;/h3&gt;&lt;i class=&quot;faded&quot;&gt;Right-click files to select them individually&lt;/i&gt;"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M22,16A2,2 0 0,1 20,18H8C6.89,18 6,17.1 6,16V4C6,2.89 6.89,2 8,2H20A2,2 0 0,1 22,4V16M16,20V22H4A2,2 0 0,1 2,20V7H4V20H16M13,14L20,7L18.59,5.59L13,11.17L9.91,8.09L8.5,9.5L13,14Z" /></svg><span>Select All</span></div><div class="stats-button sidebar-button tt" title="&lt;h3&gt;Statistics&lt;/h3&gt;&lt;i class=&quot;faded&quot;&gt;Show statistics for the current search results&lt;/i&gt;"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M17.45,15.18L22,7.31V19L22,21H2V3H4V15.54L9.5,6L16,9.78L20.24,2.45L21.97,3.45L16.74,12.5L10.23,8.75L4.31,19H6.57L10.96,11.44L17.45,15.18Z" /></svg><span>Statistics</span></div><div class="display-options-button sidebar-button tt" title="&lt;h3&gt;Display Options&lt;/h3&gt;&lt;i class=&quot;faded&quot;&gt;Scaling, grouping and sorting&lt;/i&gt;"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" /></svg><span>Display Options</span></div></div><div class="search-results" style="opacity:0;"></div></div><link rel="stylesheet" href="/stash/pages/css/search.css"/><script>stash.page.identifier().then(s=>{const a=getURLParams(s.attr("data-params")).search,t=s.find(".search-results"),e=s.find(".result-count"),i=s.find(".result-count-text"),r=stash.query.parse(a);if(s.is("#content")){const s=stash.query.toString(r);$("#searchbar input").val(s),history.replaceState(null,"",toURLParams({search:s}))}results=stash.search(r);const n=s=>{1==s?i.addClass("singular"):i.removeClass("singular"),e.text(s)},d=(s,a)=>{const t=stash.data[a].size,e=E("div").append(E("h3").text(`${stash.data[a].contributor} #${stash.data[a].id}`));stash.data[a].packageType?e.append(E("div").addClass("row").html($("#file-icon").html()+` ${stash.typeNames[stash.data[a].packageType]}`)):e.append(E("div").addClass("row").html($("#aspect-ratio-icon").html()+` ${t[0]}x${t[1]}`)),e.append(E("p").append(E("div").addClass("row").html($("#calendar-icon").html()+" "+formatDate(stash.data[a].timestamp))),stash.tags.element(a).addClass("compact").css("margin-top","12px")),s.attr("title",e[0].innerHTML)},l=a=>{s.find(".file").css({width:128*a+"px",height:128*a+"px"}),a>1?s.addClass("disable-thumbnails"):s.removeClass("disable-thumbnails")},p=(s,a)=>{let e=t.children(`.group[data-group="${a}"]`);0==e.length&&(e=E("div").addClass("group").append(E("h3").text(a)).attr("data-group",a),t.append(e)),$(s).appendTo(e)},o=()=>{t.children(".group").removeClass("hidden").each((s,a)=>{0==$(a).children(".result:visible").length&&$(a).addClass("hidden")})},c=(s,a,e)=>{const i=t.find(".result").detach();t.children(".group").remove(),"none"!=s?i.each((a,t)=>{const e=$(t).attr("data-file");if("contributor"==s){const s=stash.data[e].contributor;p(t,s)}else if("year"==s){const s=stash.data[e].date.getFullYear();p(t,s)}else if("size"==s){const s=stash.data[e].size,a=stash.data[e].packageType?"ZIP":s[1]>6*s[0]?"Animation Strips":s.join("x");p(t,a)}else if("type"==s){let s="Image";if(stash.data[e].packageType)s=stash.typeNames[stash.data[e].packageType];else{const a=stash.data[e].size;(stash.data[e].M||a[1]/a[0]>=6&&a[1]%a[0]==0)&&(s="Animation")}p(t,s)}}):i.appendTo(t);const r=s=>{const t=s.children(".result").toArray().sort((s,t)=>{const e=$(s).attr("data-file"),i=$(t).attr("data-file");if("contributor"==a){const s=naturalSorter(stash.data[e].contributor,stash.data[i].contributor);return 0!=s?s:naturalSorter(e,i)}if("id"==a)return idSort(e,i);if("size"==a){const s=stash.data[e].size,a=stash.data[i].size,t=s[0]*s[1]-a[0]*a[1];return 0!=t?t:naturalSorter(e,i)}});"des"==e&&t.reverse(),s.append(t)};if("none"!=s){const a=t.children(".group").toArray().sort((a,t)=>{const e=$(a).children("h3").text(),i=$(t).children("h3").text();if("size"==s){if("Animation Strips"==e||"ZIP"==e&&"Animation Strips"!=i)return-1;if("Animation Strips"==i||"ZIP"==i&&"Animation Strips"!=e)return 1;const s=e.split("x").map(s=>parseInt(s)),a=i.split("x").map(s=>parseInt(s));return s[0]*s[1]-a[0]*a[1]}return naturalSorter(e,i)});t.append(a),t.children(".group").each((s,a)=>{r($(a))})}else r(t);o()},h=()=>{requestAnimationFrame(()=>{t.animate({opacity:1},500),s.find(".sp-search-wrapper .sidebar").animate({opacity:1},500)})},u=()=>{const a=t.find(".result");if(0===a.length)return;const e=s.find(".sp-search-wrapper .color-picker"),i=$.farbtastic(e);if(e.is(".enabled")){s.find(".sp-search-wrapper .color-filter-button svg path").css("fill",i.color);const t=rgbToLab(hexToRgb(i.color));let e=0,r=0;n(0),a.each((s,d)=>{const l=stash.data[$(d).attr("data-file")].colors;for(let s in l)if(l.hasOwnProperty(s)&&l[s]){if(i.hsl[1]<.5&&~s.indexOf("V"))continue;if(i.hsl[1]>=.5&&~s.indexOf("M"))continue;if(deltaE(t,rgbToLab(l[s]))<=16)return $(d).removeClass("hidden"),e++,r++,n(e),void(r==a.length&&o())}$(d).addClass("hidden"),++r==a.length&&o()})}else n(t.find(".result").removeClass("hidden").length),s.find(".sp-search-wrapper .color-filter-button svg path").css("fill",""),o()};s.find(".sp-search-wrapper .expand-button").on("click",()=>s.find(".sp-search-wrapper .sidebar").toggleClass("expanded")),s.find(".sp-search-wrapper .color-filter-button").on("click",()=>{s.find(".sp-search-wrapper .color-picker").is(".enabled")?s.find(".sp-search-wrapper .color-filter-button, .sp-search-wrapper .color-picker").removeClass("enabled"):(s.find(".sp-search-wrapper .sidebar").addClass("expanded"),s.find(".sp-search-wrapper .color-filter-button, .sp-search-wrapper .color-picker").addClass("enabled"),s.find(".sp-search-wrapper .color-picker").css("opacity","")),u()}),s.find(".sp-search-wrapper .color-picker").farbtastic({callback:s.find(".sp-search-wrapper .color-picker-input"),width:200,onStop:u}),s.find(".sp-search-wrapper .color-picker-input").on("change",s=>{t.find(".result").length<500&&u()}),s.find(".sp-search-wrapper .select-all-button").on("click",()=>stash.selectFiles(s.find(".file:not(.hidden)").toArray().map(s=>$(s).attr("data-file")))),s.find(".sp-search-wrapper .stats-button").on("click",()=>{stash.page.modal(null,s.closest(".stash-page-wrapper")).find(".content").append(E("h2").text("Statistics"),stash.chart.timeline(results,{title:"Number of files over time",dataHandler:(s,a)=>s.map(s=>a[s].length).reduce((s,a)=>s.push((s.length&&s[s.length-1]||0)+a)&&s,[])},{title:"Files added per quarter",dataHandler:(s,a)=>s.map(s=>a[s].length)},{title:"Number of contributors",dataHandler:(s,a)=>s.map(s=>a[s].reduce((s,a)=>s.add(stash.data[a].contributor),new Set)).map((s,a,t)=>t.slice(0,a+1).reduce((s,a)=>(a.forEach(a=>s.add(a)),s),new Set).size)},{title:"Active contributors per quarter",dataHandler:(s,a)=>s.map(s=>a[s].reduce((s,a)=>s.add(stash.data[a].contributor),new Set).size)}))}),s.find(".sp-search-wrapper .display-options-button").on("click",()=>{const a=stash.page.modal(null,s.closest(".stash-page-wrapper"));a.find(".content").addClass("sp-search-modal").css("width","800px").append(E("h3").text("Display Scale"),E("div").addClass("display-scale").css("width","260px"),E("h3").text("Grouping"),E("div").addClass("display-grouping").css("width","260px"),E("h3").text("Sorting"),E("div").addClass("row").append(E("div").addClass("display-sorting").css("width","260px"),E("div").addClass("display-order").css("width","260px")),E("br"),E("div").addClass("button inline").text("Done").on("click",s=>{stash.displayOptions={grouping:a.find(".display-grouping")[0].val(),sorting:a.find(".display-sorting")[0].val(),order:a.find(".display-order")[0].val(),scale:parseInt(a.find(".display-scale")[0].val())},c(stash.displayOptions.grouping,stash.displayOptions.sorting,stash.displayOptions.order),l(stash.displayOptions.scale),stash.page.closeModal(a)}),E("div").addClass("button inline").text("Cancel").on("click",s=>stash.page.closeModal(a)),E("div").addClass("button inline").text("Reset").on("click",s=>{a.find(".display-grouping")[0].val("none"),a.find(".display-sorting")[0].val("id"),a.find(".display-order")[0].val("des"),a.find(".display-scale")[0].val("1")})),CCInput(a.find(".display-scale"),{select:!0,lists:[{name:"Scale Options",list:[{name:"1x"+E("span").addClass("faded").text(" - 128x128 px")[0].outerHTML,value:"1",selected:1==stash.displayOptions.scale},{name:"2x"+E("span").addClass("faded").text(" - 256x256 px")[0].outerHTML,value:"2",selected:2==stash.displayOptions.scale},{name:"3x"+E("span").addClass("faded").text(" - 384x384 px")[0].outerHTML,value:"3",selected:3==stash.displayOptions.scale},{name:"4x"+E("span").addClass("faded").text(" - 512x512 px")[0].outerHTML,value:"4",selected:4==stash.displayOptions.scale}]}]}),CCInput(a.find(".display-grouping"),{select:!0,lists:[{name:"Grouping Options",list:[{name:"No groups",value:"none",selected:"none"==stash.displayOptions.grouping},{name:"Group by contributor",value:"contributor",selected:"contributor"==stash.displayOptions.grouping},{name:"Group by year",value:"year",selected:"year"==stash.displayOptions.grouping},{name:"Group by size",value:"size",selected:"size"==stash.displayOptions.grouping},{name:"Group by type",value:"type",selected:"type"==stash.displayOptions.grouping}]}]}),CCInput(a.find(".display-sorting"),{select:!0,lists:[{name:"Sorting Options",list:[{name:"Sort by contributor",value:"contributor",selected:"contributor"==stash.displayOptions.sorting},{name:"Sort by date",value:"id",selected:"id"==stash.displayOptions.sorting},{name:"Sort by size",value:"size",selected:"size"==stash.displayOptions.sorting}]}]}),CCInput(a.find(".display-order"),{select:!0,lists:[{name:"Sort Order",list:[{name:"Ascending",value:"asc",selected:"asc"==stash.displayOptions.order},{name:"Descending",value:"des",selected:"des"==stash.displayOptions.order}]}]})}),tippy(s.find(".sp-search-wrapper .tt").toArray(),{placement:"right",dynamicTitle:!0}),s[0].onTagsUpdate=(()=>{s.find(".result").each((s,a)=>{d($(a),$(a).attr("data-file"))})}),stash.page.optimizeScrolling(s.find(".sp-search-wrapper .search-results")),(a=>{if(0==a.length)return t.append(E("div").addClass("hint").text("No results")),n(0),void h();if(a.length>2500)return t.append(E("div").addClass("hint").text("Too many results (2500+), try narrowing your search")),n(0),void h();n(a.length);for(let e=0;e<a.length;e++){let i=a[e],r=createFilePreview(i,E("a").addClass("result").attr("href",toURLParams({details:stash.data[i].id})));stash.selection.contains(i)&&r.addClass("selected"),r.on("click",a=>{stash.page.modal(toURLParams({details:stash.data[i].id}),s.closest(".stash-page-wrapper")),a.preventDefault()}),r.on("contextmenu",s=>{stash.selection.contains(i)?stash.deselectFile(i):stash.selectFile(i),s.preventDefault(),s.stopPropagation()}),d(r,i),tippy(r[0],{placement:"right",dynamicTitle:!0}),t.append(r)}c(stash.displayOptions.grouping,stash.displayOptions.sorting,stash.displayOptions.order),l(stash.displayOptions.scale),h()})(results.sort(naturalSorter))});</script><img onload="stash.page.identifierLoaded(this);void(0);" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="/>