<link rel="stylesheet" href="/stash/pages/css/mod-support-downloader.css"/><div class="sp-msdl-wrapper"><div class="sp-msdl-right-pane"><h2>Dokucraft Mod Support Packs</h2><p>Select packs you want to include on the right, then click the button below to download and merge them.</p><hr/><p>Before downloading, select the correct resource pack format below.</p><div class="row"><div class="sp-msdl-pack-format inline"></div></div><hr/><div class="row"><div class="sp-msdl-download-button inline button">Download</div><div class="filler"></div><div class="sp-msdl-deselect-all-button inline button">Deselect all</div></div></div><div class="sp-msdl-left-pane filler"><div class="sp-msdl-searchbar"></div><div class="sp-msdl-files"></div></div></div><script>stash.page.hasWork=!0,stash.page.identifier().then(e=>{const a=getURLParams(e.attr("data-params"));let s=null;a["mod-support-downloader"]&&(s=new RegExp(a["mod-support-downloader"])),$.ajax("https://dokucraft.co.uk/data.json").done(t=>{const o=e.find(".sp-msdl-files"),l={Light:"sp-msdl-dokucraft-light",Dark:"sp-msdl-dokucraft-dark",High:"sp-msdl-dokucraft-high",Dwarven:"sp-msdl-dokucraft-dwarven",None:"sp-msdl-no-flavor"};Object.values(t.packs).forEach(e=>{e.downloads.filter(e=>!(e.tags||[]).find(e=>~e.indexOf("Bedrock"))).forEach(a=>{let t=(a.tags||["None"])[0];~t.indexOf("=")&&(t=t.split("=")[1]);const r=!!(a.tags||[]).find(e=>e.match(/work in progress/i));let n=!1;s&&(n=!![e.name,a.file,a.name||e.name,a.version,t,r?"WIP":""].join(",").match(s)),o.append(E("div").addClass("sp-msdl-file "+(n?"selected":"")).attr("data-mod-support-pack",a.file).attr("data-search-string",[a.name||e.name,a.version,t].join(" ")).append(E("p").addClass("filler "+l[t]).append(E("span").text(a.name||e.name),E("span").addClass("sp-msdl-file-version").text(a.version),E("span").addClass("sp-msdl-file-flavor").text(t),r?E("span").addClass("sp-msdl-file-wip-tag").text("Work In Progress"):"")).on("click",e=>{const a=$(e.currentTarget);a.is(".selected")?a.removeClass("selected"):a.addClass("selected")}))})}),CCInput(e.find(".sp-msdl-searchbar"),{placeholder:"Search mod support packs..."}).find("input").on("input",a=>{const s=$(a.currentTarget).val();e.find(".sp-msdl-file.hidden").removeClass("hidden"),s&&s.length&&e.find(".sp-msdl-file").filter((e,a)=>!~$(a).attr("data-search-string").toLowerCase().indexOf(s.toLowerCase())).addClass("hidden")}),CCInput(e.find(".sp-msdl-pack-format"),{type:"select",lists:[{name:"Resource Pack Formats",list:[{name:"Minecraft 1.13 or later",value:4,selected:4==a.format||void 0==a.format},{name:"Minecraft 1.12 or 1.11",value:3,selected:3==a.format},{name:"Minecraft 1.10 or 1.9",value:2,selected:2==a.format},{name:"Minecraft 1.8 or earlier",value:1,selected:1==a.format}]}]}),e.find(".sp-msdl-download-button").on("click",a=>{const s=stash.notify("Downloading and merging packs. This may take a while.","working"),t=stash.blockInput(null,!1);Promise.all(o.children(".selected").toArray().map(e=>$.ajax(stash.url.cors+"https://bitbucket.org/DokucraftSaga/dokucraft-website/downloads/"+$(e).attr("data-mod-support-pack"),{xhrFields:{responseType:"blob"}}))).then(e=>Promise.all(e.map(e=>JSZip.loadAsync(e)))).then(e=>Promise.all(e.map(e=>Promise.all(Object.keys(e.files).filter(a=>!e.files[a].dir).map(a=>e.file(a).async("blob").then(e=>({name:a,content:e}))))))).then(a=>{const o=new JSZip;a.forEach(e=>e.forEach(e=>{e.name.match(/^assets/)&&o.file(e.name,e.content)})),o.file("pack.mcmeta",JSON.stringify({pack:{pack_format:parseInt(e.find(".sp-msdl-pack-format")[0].val()),description:"§7Dokucraft Mod Support\n§rGenerated by §9DokuStash"}}).replace(/§/g,"\\u00A7")),$.ajax("resources/pack.png",{xhrFields:{responseType:"blob"}}).done(e=>{o.file("pack.png",e),o.generateAsync({type:"blob"}).then(e=>{stash.dismissNotification(s),stash.removeInputBlocker(t),saveAs(e,"Dokucraft-Mod-Support.zip")})}).fail(e=>{stash.notify("Failed to download pack.png",null,"error")})})}),e.find(".sp-msdl-deselect-all-button").on("click",a=>{e.find(".sp-msdl-file.selected").removeClass("selected")}),stash.workComplete()}).fail(e=>{stash.workError(),$("#files-table").remove(),stash.notify(`Failed to load file list. (${e.status} ${e.statusText})`,null,"error")})});</script><img onload="stash.page.identifierLoaded(this);void(0);" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="/>