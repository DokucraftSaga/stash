<div class="fill"><h2 id="page-title">Dokucraft Update Status</h2><table class="js-rows highlight-rows" id="files-table" style="width:100%;"><col style="width:220px;"/><col/><col style="width:100px;"/><col style="width:100px;"/><col style="width:100px;"/><thead><tr><td class="no-extra-padding" id="total-number-of-textures"></td><td class="right-align"><span class="faded">Number of textures left:</span></td><th id="tl-light" scope="col"></th><th id="tl-dark" scope="col"></th><th id="tl-high" scope="col"></th></tr><tr><td class="right-align" colspan="2"><span class="faded">Complete:</span></td><th id="complete-light" scope="col"></th><th id="complete-dark" scope="col"></th><th id="complete-high" scope="col"></th></tr><tr><th>Category</th><th>File      <i class="faded">assets/minecraft/textures/...</i></th><th class="tt" title="Dokucraft Light&lt;br&gt;&lt;i&gt;Click to download patch&lt;/i&gt;"><a id="th-light">Light</a></th><th class="tt" title="Dokucraft Dark&lt;br&gt;&lt;i&gt;Click to download patch&lt;/i&gt;"><a id="th-dark">Dark</a></th><th class="tt" title="Dokucraft High&lt;br&gt;&lt;i&gt;Click to download patch&lt;/i&gt;"><a id="th-high">High</a></th></tr></thead></table></div><script>(()=>{stash.page.hasWork=!0;const t=/(.+\/)(.*)\.png/,a=/^\d+:.+$/,e=[85,255,136],s=[238,238,136],r=[238,51,102],o=()=>{if("wip"==stash.cache.status.gameVersion)return $("#page-title").text("Update Status Temporarily Unavailable").after(E("p").text("This page is unavailable while the file list is being updated.")),void $("#files-table").remove();$("#page-title").text("Dokucraft "+stash.cache.status.gameVersion+" Status");const o=$("#files-table");Object.keys(stash.cache.status.files).forEach(e=>{let s=E("tbody").addClass("row-group");stash.cache.status.files[e].forEach((r,o)=>{let l=t.exec(r.name),i=E("tr");0==o&&i.append(E("th").text(e).attr("rowspan",stash.cache.status.files[e].length).attr("scope","rowgroup")),i.append(E("td").addClass("filepath").append(E("span").addClass("img-container tt").attr("title",E("img").attr("src","data:image/png;base64,"+r.texture).addClass("min-128 pixelated transparent")[0].outerHTML).append(E("img").attr("src","data:image/png;base64,"+r.texture))).append(E("span").text(l[1]).addClass("faded")).append(l[2]).append(E("span").text(".png").addClass("faded")));let n=E("td").addClass("no-extra-padding light").appendTo(i);if(r.light.length>0&&!isNaN(r.light))n.text("#"+r.light).addClass("link tt good").attr("title","View file details").on("click",()=>goToPage(toURLParams({details:r.light})));else if(r.light.length>0&&r.light.match(a)){const t=r.light.split(":");n.text("#"+t[0]+"*").addClass("link tt good").attr("title",`View file details<br><i>${t[1]}</i>`).on("click",()=>goToPage(toURLParams({details:r.light})))}else r.light.length>0?n.addClass("good").text(r.light):n.addClass("bad");!isNaN(r.rowspanLight)&&r.rowspanLight.length>0&&n.attr("rowspan",r.rowspanLight);let h=E("td").addClass("no-extra-padding dark").appendTo(i);if(r.dark.length>0&&!isNaN(r.dark))h.text("#"+r.dark).addClass("link tt good").attr("title","View file details").on("click",()=>goToPage(toURLParams({details:r.dark})));else if(r.dark.length>0&&r.dark.match(a)){const t=r.dark.split(":");h.text("#"+t[0]+"*").addClass("link tt good").attr("title",`View file details<br><i>${t[1]}</i>`).on("click",()=>goToPage(toURLParams({details:r.dark})))}else r.dark.length>0?h.addClass("good").text(r.dark):h.addClass("bad");!isNaN(r.rowspanDark)&&r.rowspanDark.length>0&&h.attr("rowspan",r.rowspanDark);let d=E("td").addClass("no-extra-padding high").appendTo(i);if(r.high.length>0&&!isNaN(r.high))d.text("#"+r.high).addClass("link tt good").attr("title","View file details").on("click",()=>goToPage(toURLParams({details:r.high})));else if(r.high.length>0&&r.high.match(a)){const t=r.high.split(":");d.text("#"+t[0]+"*").addClass("link tt good").attr("title",`View file details<br><i>${t[1]}</i>`).on("click",()=>goToPage(toURLParams({details:r.high})))}else r.high.length>0?d.addClass("good").text(r.high):d.addClass("bad");!isNaN(r.rowspanHigh)&&r.rowspanHigh.length>0&&d.attr("rowspan",r.rowspanHigh),s.append(i)}),o.append(s)}),o.find("tr:even").addClass("even");let l=o.find(".filepath").length;$("#total-number-of-textures").text(l+" total textures");let i=o.find(".light:not(:empty)").toArray().reduce((t,a)=>t+($(a).attr("rowspan")?parseInt($(a).attr("rowspan")):1),0),n=i/l,h=[Math.floor(n>.5?lerp(s[0],e[0],2*n-1):lerp(r[0],s[0],2*n)),Math.floor(n>.5?lerp(s[1],e[1],2*n-1):lerp(r[1],s[1],2*n)),Math.floor(n>.5?lerp(s[2],e[2],2*n-1):lerp(r[2],s[2],2*n))];$("#tl-light").text(l-i).css("color",`rgb(${h.join(",")})`),$("#complete-light").text(Math.floor(100*n)+"%").css("color",`rgb(${h.join(",")})`);let d=o.find(".dark:not(:empty)").toArray().reduce((t,a)=>t+($(a).attr("rowspan")?parseInt($(a).attr("rowspan")):1),0),p=d/l,c=[Math.floor(p>.5?lerp(s[0],e[0],2*p-1):lerp(r[0],s[0],2*p)),Math.floor(p>.5?lerp(s[1],e[1],2*p-1):lerp(r[1],s[1],2*p)),Math.floor(p>.5?lerp(s[2],e[2],2*p-1):lerp(r[2],s[2],2*p))];$("#tl-dark").text(l-d).css("color",`rgb(${c.join(",")})`),$("#complete-dark").text(Math.floor(100*p)+"%").css("color",`rgb(${c.join(",")})`);let g=o.find(".high:not(:empty)").toArray().reduce((t,a)=>t+($(a).attr("rowspan")?parseInt($(a).attr("rowspan")):1),0),f=g/l,m=[Math.floor(f>.5?lerp(s[0],e[0],2*f-1):lerp(r[0],s[0],2*f)),Math.floor(f>.5?lerp(s[1],e[1],2*f-1):lerp(r[1],s[1],2*f)),Math.floor(f>.5?lerp(s[2],e[2],2*f-1):lerp(r[2],s[2],2*f))];$("#tl-high").text(l-g).css("color",`rgb(${m.join(",")})`),$("#complete-high").text(Math.floor(100*g/l)+"%").css("color",`rgb(${m.join(",")})`),o.floatThead({scrollContainer:t=>t.closest("#content-scroller")}),$("body").addClass("disable-sidebar-animation"),stash.page.onSidebarToggle=(()=>{o.floatThead("reflow")}),stash.page.onRemove=(()=>{o.floatThead("destroy"),$("body").removeClass("disable-sidebar-animation")}),tippy("#content-wrapper .tt",{arrow:!0,animation:"perspective"})},l=t=>{stash.workIndeterminate();const a=new JSZip,e=t.replace(/^(.)/,(t,a)=>a.toUpperCase()),s=[];Object.keys(stash.cache.status.files).forEach(a=>{stash.cache.status.files[a].forEach((a,e)=>{a[t].length>0&&s.push(a)})});const r=new Set(stash.search({id:s.map(a=>a[t].split(":")[0]).join(",")})),o=[];let l=0;a.file("pack.mcmeta",JSON.stringify({pack:{pack_format:stash.cache.status.packFormat,description:`§7Dokucraft ${e} Patch for ${stash.cache.status.gameVersion}\n§rGenerated by §9DokuStash`}}).replace(/§/g,"\\u00A7")),o.push($.ajax("resources/pack.png",{xhrFields:{responseType:"blob"}}).done(t=>{a.file("pack.png",t)}).fail(t=>{stash.notify(`Failed to download file: pack.png<br>(${t.status} ${t.statusText})`,null,"error")})),r.forEach(e=>{const r=getExt(e),i=getID(e),n=stash.data[e].S;"png"==r?s.filter(a=>a[t]==i).forEach(t=>{o.push($.ajax(stashURL+e,{xhrFields:{responseType:"blob"}}).done(e=>{a.file("assets/minecraft/textures/"+t.name,e,{createFolders:!0}),stash.setWorkProgress(Math.floor(100*++l/s.length))}).fail(t=>{stash.notify(`Failed to download file: ${e}<br>(${t.status} ${t.statusText})`,null,"error")})),stash.data[e].M?o.push($.ajax(stashURL+e+".mcmeta",{xhrFields:{responseType:"blob"}}).done(e=>{a.file("assets/minecraft/textures/"+t.name+".mcmeta",e,{createFolders:!0})}).fail(t=>{stash.notify(`Failed to download file: ${e}.mcmeta<br>(${t.status} ${t.statusText})`,null,"error")})):n[1]/n[0]>=6&&n[1]%n[0]==0&&a.file("assets/minecraft/textures/"+t.name+".mcmeta","{animation:{}}",{createFolders:!0})}):o.push(stash.getZIPContent(e).then(e=>{s.filter(a=>a[t].split(":")[0]==i).forEach(r=>{const i=r[t].split(":")[1],n=e.find(t=>i==(t.path.length>0?t.path+"/":"")+t.name).content;a.file("assets/minecraft/textures/"+r.name,n,{base64:!0,createFolders:!0});const h=e.find(t=>i+".mcmeta"==(t.path.length>0?t.path+"/":"")+t.name);h?a.file("assets/minecraft/textures/"+r.name+".mcmeta",h.content,{createFolders:!0}):o.push(stash.getImage("data:image/png;base64,"+n).then(t=>{t.height/t.width>=6&&t.height%t.width==0&&a.file("assets/minecraft/textures/"+r.name+".mcmeta","{animation:{}}",{createFolders:!0})})),stash.setWorkProgress(Math.floor(100*++l/s.length))})}))}),Promise.all(o).then(()=>{a.generateAsync({type:"blob"}).then(t=>{saveAs(t,`${stash.cache.status.gameVersion}-Dokucraft-${e}-Patch.zip`),stash.workComplete()})}).catch(t=>{stash.notify("An error occurred.<br>"+t.toString(),null,"error")})};stash.cache.status?(o(),stash.workComplete()):$.ajax(cors+"https://docs.google.com/spreadsheets/u/0/d/1b4ciAAKqsSwgVSZs1_jyAsz3ef8GPG9ijjg895PIrDw/export?format=csv&id=1b4ciAAKqsSwgVSZs1_jyAsz3ef8GPG9ijjg895PIrDw&gid=0").done(t=>{stash.cache.status={gameVersion:"n/a",files:{}},t.split("\n").map(t=>t.split(",").map(t=>t.trim())).forEach((t,a)=>{if(0==a)return stash.cache.status.gameVersion=t[0],void(stash.cache.status.packFormat=parseInt(t[1]));stash.cache.status.files.hasOwnProperty(t[0])||(stash.cache.status.files[t[0]]=[]),stash.cache.status.files[t[0]].push({name:t[1],light:t[2],dark:t[3],high:t[4],note:t[5],texture:t[9]})}),o(),$("#th-light").on("click",()=>l("light")),$("#th-dark").on("click",()=>l("dark")),$("#th-high").on("click",()=>l("high")),stash.workComplete()}).fail(t=>{stash.workError(),$("#files-table").remove(),stash.notify(`Failed to load file list. (${t.status} ${t.statusText})`,null,"error")})})();</script><style>th a {
  text-decoration: none;
  color: #58f;
  display: block;
  background-image: url(resources/download-blue.svg);
  background-position: 100% 50%;
  background-repeat: no-repeat;
  cursor: pointer;
}</style>