<div class="sp-status-download-icon svg-icon hidden"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg></div><h2 class="sp-status-page-title">Dokucraft Update Status</h2><table class="sp-status-files-table js-rows highlight-rows" style="width:100%;"><col style="width:220px;"/><col/><col style="width:100px;"/><col style="width:100px;"/><col style="width:100px;"/><thead><tr class="sp-status-missing-files-row"><td class="sp-status-total-number-of-files no-extra-padding"></td><td class="right-align"><span class="faded">Number of textures left:</span></td></tr><tr class="sp-status-complete-row"><td class="right-align" colspan="2"><span class="faded">Complete:</span></td></tr><tr class="sp-status-pack-name-row"><th>Category</th><th>File      <i class="faded">assets/minecraft/textures/...</i></th></tr></thead></table><link rel="stylesheet" href="/stash/pages/css/status.css"/><script>stash.page.hasWork=!0,stash.page.identifier().then(t=>{const s=getURLParams(t.attr("data-params")),a=/(.+\/)(.*)\.png/,e=/^\d+:.+$/,l=[85,255,136],r=[255,238,119],i=[238,51,102],o=()=>{if("wip"==stash.status.sheetStatus)return t.find(".sp-status-page-title").text("Update Status Temporarily Unavailable").after(E("p").text("This page is unavailable while the file list is being updated.")),void t.find(".sp-status-files-table").remove();t.find(".sp-status-page-title").text(stash.status.listTitle+" Status");const s=t.find(".sp-status-files-table");Object.keys(stash.status.files).forEach(t=>{if("Hidden"==t)return;let l=E("tbody").addClass("row-group");stash.status.files[t].forEach((s,r)=>{let i=a.exec(s.name),o=E("tr");0==r&&o.append(E("th").text(t).attr("rowspan",stash.status.files[t].length).attr("scope","rowgroup")),o.append(E("td").addClass("filepath").append(s.texture.length?E("span").addClass("img-container tt").attr("title",E("img").attr("src","data:image/png;base64,"+s.texture).addClass("min-128 pixelated transparent")[0].outerHTML).append(E("img").attr("src","data:image/png;base64,"+s.texture)):"").append(E("span").text(i[1]).addClass("faded")).append(i[2]).append(E("span").text(".png").addClass("faded"))),stash.status.packNames.forEach(t=>{const a=E("td").addClass("no-extra-padding light").appendTo(o);if(s.packs[t]&&s.packs[t].length>0&&!isNaN(s.packs[t])){const e="model"==stash.data[stash.nameOf(s.packs[t])].packageType;a.append(E("a").text((e?"ðŸ—˜ #":"#")+s.packs[t]).attr("href",toURLParams({details:s.packs[t]}))).addClass("link tt good").attr("title","View file details"+(e?'<br><i class="faded">Replaced by a custom model</i>':"")).on("click",a=>{stash.page.modal(toURLParams({details:s.packs[t]})).children(".content").css("width","800px"),a.preventDefault()})}else if(s.packs[t]&&s.packs[t].length>0&&s.packs[t].match(e)){const e=s.packs[t].split(":");a.append(E("a").text("#"+e[0]+"*").attr("href",toURLParams({details:s.packs[t]}))).addClass("link tt good").attr("title",`View file details<br><i class="faded">${e[1]}</i>`).on("click",a=>{stash.page.modal(toURLParams({details:s.packs[t]})).children(".content").css("width","800px"),a.preventDefault()})}else s.packs[t]&&s.packs[t].length>0?a.addClass("good").text(s.packs[t]):a.addClass("bad")}),l.append(o)}),s.append(l)}),s.find("tr:even").addClass("even");const o=Object.keys(stash.status.files).filter(t=>"Hidden"!=t).reduce((t,s)=>t+stash.status.files[s].length,0);t.find(".sp-status-total-number-of-files").text(o+" total files"),stash.status.packNames.forEach(s=>{const a=Object.keys(stash.status.files).filter(t=>"Hidden"!=t).reduce((t,a)=>t+stash.status.files[a].filter(t=>t.packs[s]&&t.packs[s].length).length,0),e=a/o,p=[Math.floor(e>.5?lerp(r[0],l[0],2*e-1):lerp(i[0],r[0],2*e)),Math.floor(e>.5?lerp(r[1],l[1],2*e-1):lerp(i[1],r[1],2*e)),Math.floor(e>.5?lerp(r[2],l[2],2*e-1):lerp(i[2],r[2],2*e))];t.find(".sp-status-missing-files-row").append(E("th").attr("scope","col").text(o-a).css("color",`rgb(${p.join(",")})`)),t.find(".sp-status-complete-row").append(E("th").attr("scope","col").text(Math.floor(100*e)+"%").css("color",`rgb(${p.join(",")})`)),t.find(".sp-status-pack-name-row").append(E("th").addClass("tt").attr("title",stash.status.packTitles[s]+'<br><i class="faded">Click to download patch</i>').append(E("a").html(s+t.find(".sp-status-download-icon").html()).on("click",()=>n(s))))}),s.floatThead({scrollContainer:()=>s.closest(".stash-page-scroller")}),t[0].onUnload=(()=>{s.floatThead("destroy")}),tippy(t.closest(".stash-page-wrapper").find(".tt").toArray())},n=t=>{stash.workIndeterminate();const s=new JSZip,a=[];Object.keys(stash.status.files).forEach(s=>{stash.status.files[s].forEach(s=>{s.packs[t]&&s.packs[t].length>0&&(s.packs[t].match(e)||"model"!=stash.data[stash.nameOf(s.packs[t])].packageType)&&a.push(s)})});const l=new Set(stash.search(a.map(s=>s.packs[t].split(":")[0]).join("|"))),r=[];let i=0;s.file("pack.mcmeta",JSON.stringify({pack:{pack_format:stash.status.packFormat,description:`Â§7${stash.status.packTitles[t]} Patch ${stash.status.versionNumber}\nÂ§rGenerated by Â§9DokuStash`}}).replace(/Â§/g,"\\u00A7")),r.push($.ajax("resources/pack.png",{xhrFields:{responseType:"blob"}}).done(t=>{s.file("pack.png",t)}).fail(t=>{stash.notify(`Failed to download file: pack.png<br>(${t.status} ${t.statusText})`,null,"error")})),l.forEach(e=>{const l=stash.data[e].ext,o=stash.data[e].id,n=stash.data[e].size;"png"==l?a.filter(s=>s.packs[t]==o).forEach(t=>{const l=t.name.match(/^assets\//)?"":"assets/minecraft/textures/";r.push($.ajax(stash.url.files+e,{xhrFields:{responseType:"blob"}}).done(e=>{s.file(l+t.name,e,{createFolders:!0}),stash.setWorkProgress(Math.floor(100*++i/a.length))}).fail(t=>{stash.notify(`Failed to download file: ${e}<br>(${t.status} ${t.statusText})`,null,"error")})),stash.data[e].mcmeta?r.push($.ajax(stash.url.files+e+".mcmeta",{xhrFields:{responseType:"blob"}}).done(a=>{s.file(l+t.name+".mcmeta",a,{createFolders:!0})}).fail(t=>{stash.notify(`Failed to download file: ${e}.mcmeta<br>(${t.status} ${t.statusText})`,null,"error")})):n[1]/n[0]>=6&&n[1]%n[0]==0&&s.file(l+t.name+".mcmeta",'{"animation":{}}',{createFolders:!0})}):r.push(stash.getZIPContent(e).then(e=>{a.filter(s=>s.packs[t].split(":")[0]==o).forEach(l=>{const o=l.name.match(/^assets\//)?"":"assets/minecraft/textures/",n=l.packs[t].split(":")[1],p=e.find(t=>n==(t.path.length>0?t.path+"/":"")+t.name),c=p.content;s.file(o+l.name,c,{base64:p.encoded,createFolders:!0});const d=e.find(t=>n+".mcmeta"==(t.path.length>0?t.path+"/":"")+t.name);d?s.file(o+l.name+".mcmeta",d.content,{createFolders:!0}):l.name.match(/\.png$/)&&r.push(stash.getImage("data:image/png;base64,"+c).then(t=>{t.height/t.width>=6&&t.height%t.width==0&&s.file(o+l.name+".mcmeta",'{"animation":{}}',{createFolders:!0})})),stash.setWorkProgress(Math.floor(100*++i/a.length))})}))}),Promise.all(r).then(()=>{s.generateAsync({type:"blob"}).then(s=>{saveAs(s,`${stash.status.filenameFormat.replace(/\$\{pack\}/gi,t)}.zip`),stash.workComplete()})}).catch(t=>{stash.notify("An error occurred.<br>"+t.toString(),null,"error")})};stash.firebase.db.collection("stash").doc("status").get().then(t=>{if(!0===s.status&&(s.status=t.get("default")),stash.status&&stash.status.listName==s.status)o(),stash.workComplete();else{const a=t.get("lists")[s.status];$.ajax(`https://sheets.googleapis.com/v4/spreadsheets/${a}/values/Files?key=AIzaSyDI3why1XpiyiVsE7qxI7aTOvEyLgaZcbA`).done(t=>{stash.status={listName:s.status,files:{}},t.values.forEach((t,s)=>{if(0==s)return stash.status.versionNumber=t[0],stash.status.sheetStatus=t[1],stash.status.filenameFormat=t[2],void(stash.status.packNames=t.slice(3));if(1==s)return stash.status.listTitle=t[0],stash.status.packFormat=parseInt(t[1]),stash.status.packTitles={},void t.slice(3).forEach((t,s)=>stash.status.packTitles[stash.status.packNames[s]]=t);stash.status.files.hasOwnProperty(t[0])||(stash.status.files[t[0]]=[]);const a={texture:t[1],name:t[2],packs:{}};stash.status.packNames.forEach((s,e)=>{a.packs[s]=t[3+e]}),stash.status.files[t[0]].push(a)}),o(),stash.workComplete()}).fail(t=>{stash.workError(),$("#files-table").remove(),stash.notify(`Failed to load file list. (${t.status} ${t.statusText})`,null,"error")})}})});</script><img onload="stash.page.identifierLoaded(this);void(0);" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="/>