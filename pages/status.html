<link rel="stylesheet" href="/stash/pages/css/status.css"/><div class="sp-status-cube-icon svg-icon hidden"><?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5M12,4.15L6.04,7.5L12,10.85L17.96,7.5L12,4.15M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z" /></svg></div><div class="sp-status-wrapper" style="opacity:0;"><h1 class="sp-status-page-title"></h1><div class="sp-status-top-section"><div class="sp-status-pack-statuses"></div><span class="sp-status-status-text warning"></span></div><table class="sp-status-files-table js-rows highlight-rows"><col style="width:220px;"/><col class="sp-status-filepath-col"/><thead><tr class="sp-status-pack-name-row"><th>Category</th><th>File      <i class="sp-status-root-dir faded"></i></th></tr></thead></table></div><script>stash.page.hasWork=!0,stash.page.identifier().then(s=>{const t=getURLParams(s.attr("data-params")),a=/(.+\/)(.*)\.png/,e=/^\d+:.+$/,r=()=>{if("wip"==stash.status.sheetStatus)return s.find(".sp-status-page-title").text("Update Status Temporarily Unavailable").after(E("p").text("This page is unavailable while the file list is being updated. Check back in a few minutes.")),s.find(".sp-status-files-table,.sp-status-top-section").remove(),void s.find(".sp-status-wrapper").css("opacity",1);s.find(".sp-status-page-title").text(stash.status.listTitle),stash.status.packNames.forEach(t=>{s.find(".sp-status-pack-name-row").append(E("th").text(t)),s.find(".sp-status-filepath-col").after(E("col").css("width","100px"))}),s.find(".sp-status-pack-statuses").append(stash.status.packNames.map(t=>{const a=Object.values(stash.status.files).reduce((s,a)=>s.concat(a.map(s=>s.packs[t]).filter(s=>s&&s.length)),[]),e=Array.from(new Set(a.map(s=>s.split(":")[0]))).map(s=>stash.nameOf(s)),r=stash.bounds(e).join("-");let o=[];const p=s=>{if(!stash.data.hasOwnProperty(s))return;const t=stash.data[s];o.push(t.contributor),t.hasOwnProperty("parents")&&t.parents.length>0&&t.parents.forEach(s=>!isNaN(s)&&p(stash.nameOf(s)))};return e.forEach(s=>p(s)),o=o.filter((s,t,a)=>t===a.indexOf(s)).sort(naturalSorter),E("div").addClass("sp-status-pack-status").append(E("h2").text(stash.status.packTitles[t]),E("div").addClass("sp-status-pack-progress-bar-container").append(E("div").addClass("sp-status-pack-progress-bar").css("width",Math.floor(100*stash.status.packStatus[t].progress)+"%").append(E("span").addClass("row").append(Math.floor(100*stash.status.packStatus[t].progress)+"% – ",E("sup").text(stash.status.packStatus[t].fileCount+" / "+stash.status.totalFileCount)," – ",E("sup").text(stash.status.totalFileCount-stash.status.packStatus[t].fileCount+" remaining")))),e.length?E("div").addClass("row").append(stash.modalAnchor({search:r,mask:stash.createMask(e,stash.search(r)),sc:"status-view-files"},s.closest(".stash-page-wrapper")).text("View files"),E("span").addClass("link").text("Contributors").on("click",t=>{const a=stash.page.modal(null,s.closest(".stash-page-wrapper"));a.find(".content").css("width","800px").append(E("h1").text("Patch Contributors"),o.map(s=>E("div").addClass("row sp-status-contributor").append(E("span").text(s).addClass("filler"),stash.modalAnchor({profile:s},a.closest(".stash-page-wrapper")).text("Profile"),stash.modalAnchor({search:stash.query.contributor(s)},a.closest(".stash-page-wrapper")).text("Files"))))}),stash.status.showDownloadLinks?E("span").addClass("link").text("Download patch").on("click",s=>n(t)):""):E("div").addClass("row").append(E("span").addClass("faded").text("View files"),E("span").addClass("faded").text("Contributors"),stash.status.showDownloadLinks?E("span").addClass("faded").text("Download patch"):""))})),s.find(".sp-status-status-text").text(stash.status.text),stash.status.rootDir.length&&s.find(".sp-status-root-dir").text(stash.status.rootDir+"...");const t=s.find(".sp-status-files-table");Object.keys(stash.status.files).forEach(s=>{if("Hidden"==s)return;let r=E("tbody").addClass("row-group");stash.status.files[s].forEach((t,n)=>{let o=a.exec(t.name),p=E("tr");0==n&&p.append(E("th").text(s).attr("rowspan",stash.status.files[s].length).attr("scope","rowgroup")),p.append(E("td").addClass("filepath").append(t.texture.length?E("span").addClass("img-container tt").attr("title",E("img").attr("src",t.texture).addClass("min-128 pixelated transparent")[0].outerHTML).append(E("img").attr("src",t.texture)):"").append(E("span").text(o[1]).addClass("faded")).append(o[2]).append(E("span").text(".png").addClass("faded"))),stash.status.packNames.forEach(s=>{const a=E("td").addClass("no-extra-padding").appendTo(p);if(t.packs[s]&&t.packs[s].length>0&&!isNaN(t.packs[s])){const e="model"==stash.data[stash.nameOf(t.packs[s])].packageType;a.append(E("a").attr("href",toURLParams({details:t.packs[s]})).append(e?E("span").addClass("sp-status-replaced-by-model-icon").html($(".sp-status-cube-icon").html()):"","#",t.packs[s])).addClass("link tt good").attr("title","View file details"+(e?'<br><i class="faded">Replaced by a custom model</i>':"")).on("click",a=>{stash.page.modal(toURLParams({details:t.packs[s]})).children(".content").css("width","800px"),a.preventDefault()})}else if(t.packs[s]&&t.packs[s].length>0&&t.packs[s].match(e)){const e=t.packs[s].split(":");a.append(E("a").text("#"+e[0]+"*").attr("href",toURLParams({details:t.packs[s]}))).addClass("link tt good").attr("title",`View file details<br><i class="faded">${e[1]}</i>`).on("click",a=>{stash.page.modal(toURLParams({details:t.packs[s]})).children(".content").css("width","800px"),a.preventDefault()})}else t.packs[s]&&t.packs[s].length>0?a.addClass("good").text(t.packs[s]):a.addClass("bad")}),r.append(p)}),t.append(r)}),t.find("tr:even").addClass("even"),requestAnimationFrame(()=>s.find(".sp-status-wrapper").animate({opacity:1},500)),tippy(s.find(".tt").toArray())},n=s=>{stash.workIndeterminate();const t=new JSZip,a=[];Object.keys(stash.status.files).forEach(t=>{stash.status.files[t].forEach(t=>{t.packs[s]&&t.packs[s].length>0&&(t.packs[s].match(e)||"model"!=stash.data[stash.nameOf(t.packs[s])].packageType)&&a.push(t)})});const r=Array.from(new Set(a.map(t=>t.packs[s].split(":")[0]))).map(s=>stash.nameOf(s)),n=[];let o=0;t.file("pack.mcmeta",JSON.stringify({pack:{pack_format:stash.status.packFormat,description:`§7${stash.status.mcmetaDesc.replace(/\$\{packTitle\}/g,stash.status.packTitles[s])}\n§rGenerated by §9DokuStash`}}).replace(/§/g,"\\u00A7")),n.push($.ajax("resources/pack.png",{xhrFields:{responseType:"blob"}}).done(s=>{t.file("pack.png",s)}).fail(s=>{stash.notify(`Failed to download file: pack.png<br>(${s.status} ${s.statusText})`,null,"error")})),r.forEach(e=>{const r=stash.data[e].ext,p=stash.data[e].id,l=stash.data[e].size;"png"==r?a.filter(t=>t.packs[s]==p).forEach(s=>{const r=s.name.match(/^assets\//)?"":stash.status.rootDir;n.push($.ajax(stash.url.files+e,{xhrFields:{responseType:"blob"}}).done(e=>{t.file(r+s.name,e,{createFolders:!0}),stash.setWorkProgress(Math.floor(100*++o/a.length))}).fail(s=>{stash.notify(`Failed to download file: ${e}<br>(${s.status} ${s.statusText})`,null,"error")})),stash.data[e].mcmeta?n.push($.ajax(stash.url.files+e+".mcmeta",{xhrFields:{responseType:"blob"}}).done(a=>{t.file(r+s.name+".mcmeta",a,{createFolders:!0})}).fail(s=>{stash.notify(`Failed to download file: ${e}.mcmeta<br>(${s.status} ${s.statusText})`,null,"error")})):l[1]/l[0]>=6&&l[1]%l[0]==0&&t.file(r+s.name+".mcmeta",'{"animation":{}}',{createFolders:!0})}):n.push(stash.getZIPContent(e).then(r=>{a.filter(t=>t.packs[s].split(":")[0]==p).forEach(p=>{const l=p.name.match(/^assets\//)?"":stash.status.rootDir,i=p.packs[s].split(":")[1],h=r.find(s=>i==(s.path.length>0?s.path+"/":"")+s.name);h||console.error("File in ZIP not found: ",e,i);const d=h.content;t.file(l+p.name,d,{base64:h.encoded,createFolders:!0});const c=r.find(s=>i+".mcmeta"==(s.path.length>0?s.path+"/":"")+s.name);c?t.file(l+p.name+".mcmeta",c.content,{createFolders:!0}):p.name.match(/\.png$/)&&n.push(stash.getImage("data:image/png;base64,"+d).then(s=>{s.height/s.width>=6&&s.height%s.width==0&&t.file(l+p.name+".mcmeta",'{"animation":{}}',{createFolders:!0})})),stash.setWorkProgress(Math.floor(100*++o/a.length))})}))}),Promise.all(n).then(()=>{t.generateAsync({type:"blob"}).then(t=>{saveAs(t,`${stash.status.filenameFormat.replace(/\$\{pack\}/gi,s)}.zip`),stash.workComplete()})}).catch(s=>{stash.notify("An error occurred.<br>"+s.toString(),null,"error")})};stash.firebase.db.collection("stash").doc("status").get().then(s=>{if(!0===t.status&&(t.status=s.get("default")),stash.status&&stash.status.listName==t.status)r(),stash.workComplete();else{const a=s.get("lists")[t.status];$.ajax(`https://sheets.googleapis.com/v4/spreadsheets/${a}/values/Files?key=AIzaSyDI3why1XpiyiVsE7qxI7aTOvEyLgaZcbA`).done(s=>{stash.status={listName:t.status,files:{}},s.values.forEach((s,t)=>{if(0==t)return stash.status.listTitle=s[0],stash.status.sheetStatus=s[1],stash.status.filenameFormat=s[2],void(stash.status.packNames=s.slice(3));if(1==t)return stash.status.mcmetaDesc=s[0],stash.status.packFormat=parseInt(s[1]),stash.status.text=s[2],stash.status.packTitles={},void s.slice(3).forEach((s,t)=>stash.status.packTitles[stash.status.packNames[t]]=s);if(2==t)return stash.status.showDownloadLinks="false"!=(s[1]||"true").toLowerCase(),void("_root_"==s[2]?stash.status.rootDir="":stash.status.rootDir=s[2]&&s[2].length?s[2]:"assets/minecraft/textures/");stash.status.files.hasOwnProperty(s[0])||(stash.status.files[s[0]]=[]);const a={name:s[2],packs:{}};s[1]&&s[1].length?a.texture=s[1].match(/:/)?s[1]:"data:image/png;base64,"+s[1]:a.texture="",stash.status.packNames.forEach((t,e)=>{a.packs[t]="string"==typeof s[3+e]?s[3+e].trim():void 0}),stash.status.files[s[0]].push(a)}),stash.status.totalFileCount=Object.keys(stash.status.files).filter(s=>"Hidden"!=s).reduce((s,t)=>s+stash.status.files[t].length,0),stash.status.packStatus={},stash.status.packNames.forEach(s=>{stash.status.packStatus[s]={fileCount:Object.keys(stash.status.files).filter(s=>"Hidden"!=s).reduce((t,a)=>t+stash.status.files[a].filter(t=>t.packs[s]&&t.packs[s].length).length,0)},stash.status.packStatus[s].progress=stash.status.packStatus[s].fileCount/stash.status.totalFileCount}),r(),stash.workComplete()}).fail(s=>{stash.workError(),stash.notify(`Failed to load file list. (${s.status} ${s.statusText})`,null,"error"),console.error(s)})}})});</script><img onload="stash.page.identifierLoaded(this);void(0);" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="/>