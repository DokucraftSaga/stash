<h2 id="page-title">Dokucraft Update Status</h2><table class="js-rows highlight-rows" id="files-table" style="width:100%;"><col style="width:220px;"/><col/><col style="width:100px;"/><col style="width:100px;"/><col style="width:100px;"/><thead><tr><td class="no-extra-padding" id="total-number-of-textures"></td><td class="right-align"><span class="faded">Number of textures left:</span></td><th id="tl-light" scope="col"></th><th id="tl-dark" scope="col"></th><th id="tl-high" scope="col"></th></tr><tr><td class="right-align" colspan="2"><span class="faded">Complete:</span></td><th id="complete-light" scope="col"></th><th id="complete-dark" scope="col"></th><th id="complete-high" scope="col"></th></tr><tr><th>Category</th><th>File      <i class="faded">assets/minecraft/textures/...</i></th><th class="tt" title="Dokucraft Light&lt;br&gt;&lt;i class=&quot;faded&quot;&gt;Click to download patch&lt;/i&gt;"><a id="th-light">Light<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg></a></th><th class="tt" title="Dokucraft Dark&lt;br&gt;&lt;i class=&quot;faded&quot;&gt;Click to download patch&lt;/i&gt;"><a id="th-dark">Dark<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg></a></th><th class="tt" title="Dokucraft High&lt;br&gt;&lt;i class=&quot;faded&quot;&gt;Click to download patch&lt;/i&gt;"><a id="th-high">High<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg></a></th></tr></thead></table><link rel="stylesheet" href="/stash/pages/css/status.css"/><script>stash.page.hasWork=!0,stash.page.identifier().then(t=>{const a=getURLParams(t.attr("data-params")),e=/(.+\/)(.*)\.png/,s=/^\d+:.+$/,l=[85,255,136],r=[255,238,119],o=[238,51,102],i=()=>{if("wip"==stash.cache.status.gameVersion)return $("#page-title").text("Update Status Temporarily Unavailable").after(E("p").text("This page is unavailable while the file list is being updated.")),void $("#files-table").remove();$("#page-title").text("Dokucraft "+stash.cache.status.gameVersion+" Status");const a=$("#files-table");Object.keys(stash.cache.status.files).forEach(t=>{if("Hidden"==t)return;let l=E("tbody").addClass("row-group");stash.cache.status.files[t].forEach((a,r)=>{let o=e.exec(a.name),i=E("tr");0==r&&i.append(E("th").text(t).attr("rowspan",stash.cache.status.files[t].length).attr("scope","rowgroup")),i.append(E("td").addClass("filepath").append(a.texture.length?E("span").addClass("img-container tt").attr("title",E("img").attr("src","data:image/png;base64,"+a.texture).addClass("min-128 pixelated transparent")[0].outerHTML).append(E("img").attr("src","data:image/png;base64,"+a.texture)):"").append(E("span").text(o[1]).addClass("faded")).append(o[2]).append(E("span").text(".png").addClass("faded")));let d=E("td").addClass("no-extra-padding light").appendTo(i);if(a.light.length>0&&!isNaN(a.light)){const t="model"==stash.data[stash.nameOf(a.light)].packageType;d.append(E("a").text((t?"ðŸ—˜ #":"#")+a.light).attr("href",toURLParams({details:a.light}))).addClass("link tt good").attr("title","View file details"+(t?'<br><i class="faded">Replaced by a custom model</i>':"")).on("click",t=>{stash.page.modal(toURLParams({details:a.light})).children(".content").css("width","800px"),t.preventDefault()})}else if(a.light.length>0&&a.light.match(s)){const t=a.light.split(":");d.append(E("a").text("#"+t[0]+"*").attr("href",toURLParams({details:a.light}))).addClass("link tt good").attr("title",`View file details<br><i class="faded">${t[1]}</i>`).on("click",t=>{stash.page.modal(toURLParams({details:a.light})).children(".content").css("width","800px"),t.preventDefault()})}else a.light.length>0?d.addClass("good").text(a.light):d.addClass("bad");let h=E("td").addClass("no-extra-padding dark").appendTo(i);if(a.dark.length>0&&!isNaN(a.dark)){const t="model"==stash.data[stash.nameOf(a.dark)].packageType;h.append(E("a").text((t?"ðŸ—˜ #":"#")+a.dark).attr("href",toURLParams({details:a.dark}))).addClass("link tt good").attr("title","View file details"+(t?'<br><i class="faded">Replaced by a custom model</i>':"")).on("click",t=>{stash.page.modal(toURLParams({details:a.dark})).children(".content").css("width","800px"),t.preventDefault()})}else if(a.dark.length>0&&a.dark.match(s)){const t=a.dark.split(":");h.append(E("a").text("#"+t[0]+"*").attr("href",toURLParams({details:a.dark}))).addClass("link tt good").attr("title",`View file details<br><i class="faded">${t[1]}</i>`).on("click",t=>{stash.page.modal(toURLParams({details:a.dark})).children(".content").css("width","800px"),t.preventDefault()})}else a.dark.length>0?h.addClass("good").text(a.dark):h.addClass("bad");let n=E("td").addClass("no-extra-padding high").appendTo(i);if(a.high.length>0&&!isNaN(a.high)){const t="model"==stash.data[stash.nameOf(a.high)].packageType;n.append(E("a").text((t?"ðŸ—˜ #":"#")+a.high).attr("href",toURLParams({details:a.high}))).addClass("link tt good").attr("title","View file details"+(t?'<br><i class="faded">Replaced by a custom model</i>':"")).on("click",t=>{stash.page.modal(toURLParams({details:a.high})).children(".content").css("width","800px"),t.preventDefault()})}else if(a.high.length>0&&a.high.match(s)){const t=a.high.split(":");n.append(E("a").text("#"+t[0]+"*").attr("href",toURLParams({details:a.high}))).addClass("link tt good").attr("title",`View file details<br><i class="faded">${t[1]}</i>`).on("click",t=>{stash.page.modal(toURLParams({details:a.high})).children(".content").css("width","800px"),t.preventDefault()})}else a.high.length>0?n.addClass("good").text(a.high):n.addClass("bad");l.append(i)}),a.append(l)}),a.find("tr:even").addClass("even");let i=a.find(".filepath").length;$("#total-number-of-textures").text(i+" total textures");let h=a.find(".light:not(:empty)").toArray().reduce((t,a)=>t+($(a).attr("rowspan")?parseInt($(a).attr("rowspan")):1),0),n=h/i,c=[Math.floor(n>.5?lerp(r[0],l[0],2*n-1):lerp(o[0],r[0],2*n)),Math.floor(n>.5?lerp(r[1],l[1],2*n-1):lerp(o[1],r[1],2*n)),Math.floor(n>.5?lerp(r[2],l[2],2*n-1):lerp(o[2],r[2],2*n))];$("#tl-light").text(i-h).css("color",`rgb(${c.join(",")})`),$("#complete-light").text(Math.floor(100*n)+"%").css("color",`rgb(${c.join(",")})`);let p=a.find(".dark:not(:empty)").toArray().reduce((t,a)=>t+($(a).attr("rowspan")?parseInt($(a).attr("rowspan")):1),0),g=p/i,f=[Math.floor(g>.5?lerp(r[0],l[0],2*g-1):lerp(o[0],r[0],2*g)),Math.floor(g>.5?lerp(r[1],l[1],2*g-1):lerp(o[1],r[1],2*g)),Math.floor(g>.5?lerp(r[2],l[2],2*g-1):lerp(o[2],r[2],2*g))];$("#tl-dark").text(i-p).css("color",`rgb(${f.join(",")})`),$("#complete-dark").text(Math.floor(100*g)+"%").css("color",`rgb(${f.join(",")})`);let m=a.find(".high:not(:empty)").toArray().reduce((t,a)=>t+($(a).attr("rowspan")?parseInt($(a).attr("rowspan")):1),0),u=m/i,k=[Math.floor(u>.5?lerp(r[0],l[0],2*u-1):lerp(o[0],r[0],2*u)),Math.floor(u>.5?lerp(r[1],l[1],2*u-1):lerp(o[1],r[1],2*u)),Math.floor(u>.5?lerp(r[2],l[2],2*u-1):lerp(o[2],r[2],2*u))];$("#tl-high").text(i-m).css("color",`rgb(${k.join(",")})`),$("#complete-high").text(Math.floor(100*m/i)+"%").css("color",`rgb(${k.join(",")})`),a.floatThead({scrollContainer:()=>a.closest(".stash-page-scroller")}),$("body").addClass("disable-sidebar-animation"),t[0].onSidebarToggle=(()=>{a.floatThead("reflow")}),t[0].onUnload=(()=>{a.floatThead("destroy"),$("body").removeClass("disable-sidebar-animation")}),tippy(t.closest(".stash-page-wrapper").find(".tt").toArray()),$("#th-light").on("click",()=>d("light")),$("#th-dark").on("click",()=>d("dark")),$("#th-high").on("click",()=>d("high"))},d=t=>{stash.workIndeterminate();const a=new JSZip,e=t.replace(/^(.)/,(t,a)=>a.toUpperCase()),l=[];Object.keys(stash.cache.status.files).forEach(a=>{stash.cache.status.files[a].forEach(a=>{a[t].length>0&&(a[t].match(s)||"model"!=stash.data[stash.nameOf(a[t])].packageType)&&l.push(a)})});const r=new Set(stash.search(l.map(a=>a[t].split(":")[0]).join("|"))),o=[];let i=0;a.file("pack.mcmeta",JSON.stringify({pack:{pack_format:stash.cache.status.packFormat,description:`Â§7Dokucraft ${e} Patch ${stash.cache.status.gameVersion}\nÂ§rGenerated by Â§9DokuStash`}}).replace(/Â§/g,"\\u00A7")),o.push($.ajax("resources/pack.png",{xhrFields:{responseType:"blob"}}).done(t=>{a.file("pack.png",t)}).fail(t=>{stash.notify(`Failed to download file: pack.png<br>(${t.status} ${t.statusText})`,null,"error")})),r.forEach(e=>{const s=stash.data[e].ext,r=stash.data[e].id,d=stash.data[e].size;"png"==s?l.filter(a=>a[t]==r).forEach(t=>{const s=t.name.match(/^assets\//)?"":"assets/minecraft/textures/";o.push($.ajax(stash.url.files+e,{xhrFields:{responseType:"blob"}}).done(e=>{a.file(s+t.name,e,{createFolders:!0}),stash.setWorkProgress(Math.floor(100*++i/l.length))}).fail(t=>{stash.notify(`Failed to download file: ${e}<br>(${t.status} ${t.statusText})`,null,"error")})),stash.data[e].mcmeta?o.push($.ajax(stash.url.files+e+".mcmeta",{xhrFields:{responseType:"blob"}}).done(e=>{a.file(s+t.name+".mcmeta",e,{createFolders:!0})}).fail(t=>{stash.notify(`Failed to download file: ${e}.mcmeta<br>(${t.status} ${t.statusText})`,null,"error")})):d[1]/d[0]>=6&&d[1]%d[0]==0&&a.file(s+t.name+".mcmeta",'{"animation":{}}',{createFolders:!0})}):o.push(stash.getZIPContent(e).then(e=>{l.filter(a=>a[t].split(":")[0]==r).forEach(s=>{const r=s.name.match(/^assets\//)?"":"assets/minecraft/textures/",d=s[t].split(":")[1],h=e.find(t=>d==(t.path.length>0?t.path+"/":"")+t.name),n=h.content;a.file(r+s.name,n,{base64:h.encoded,createFolders:!0});const c=e.find(t=>d+".mcmeta"==(t.path.length>0?t.path+"/":"")+t.name);c?a.file(r+s.name+".mcmeta",c.content,{createFolders:!0}):s.name.match(/\.png$/)&&o.push(stash.getImage("data:image/png;base64,"+n).then(t=>{t.height/t.width>=6&&t.height%t.width==0&&a.file(r+s.name+".mcmeta",'{"animation":{}}',{createFolders:!0})})),stash.setWorkProgress(Math.floor(100*++i/l.length))})}))}),Promise.all(o).then(()=>{a.generateAsync({type:"blob"}).then(t=>{saveAs(t,`${stash.cache.status.gameVersion}-Dokucraft-${e}-Patch.zip`),stash.workComplete()})}).catch(t=>{stash.notify("An error occurred.<br>"+t.toString(),null,"error")})};stash.firebase.db.collection("stash").doc("status").get().then(t=>{if(!0===a.status&&(a.status=t.get("default")),stash.cache.status&&stash.cache.status.gameVersion==a.status)i(),stash.workComplete();else{const e=t.get("lists")[a.status];$.ajax(`${stash.url.cors}https://docs.google.com/spreadsheets/u/0/d/${e}/export?format=csv&gid=0`).done(t=>{stash.cache.status={gameVersion:"n/a",files:{}},t.split("\n").map(t=>t.split(",").map(t=>t.trim())).forEach((t,a)=>{if(0==a)return stash.cache.status.gameVersion=t[0],void(stash.cache.status.packFormat=parseInt(t[1]));stash.cache.status.files.hasOwnProperty(t[0])||(stash.cache.status.files[t[0]]=[]),stash.cache.status.files[t[0]].push({texture:t[1],name:t[2],light:t[3],dark:t[4],high:t[5]})}),i(),stash.workComplete()}).fail(t=>{stash.workError(),$("#files-table").remove(),stash.notify(`Failed to load file list. (${t.status} ${t.statusText})`,null,"error")})}})});</script><img onload="stash.page.identifierLoaded(this);void(0);" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="/>