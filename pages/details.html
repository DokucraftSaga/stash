<div class="fill"><h2>File details</h2><div class="block"><div class="no-action x1" id="texture-preview"></div><div class="info"><p>Made by <a class="contributor-name"></a> (<a class="profile-link">Profile</a>)</p><p class="append-file-path">ID: <a class="file-id"></a></p><p>Category: <a class="file-category"></a></p><p class="png-only">Size: <span class="image-size"></span></p><p class="zip-only">Type: <span class="zip-type"></span></p><p>Date: <span class="file-date"></span></p></div></div><div id="misc-stats"></div><br/><div id="package-info"></div></div><script>(()=>{const t=getURLParams().details.split(":"),a=t[0],e=t[1],o=stash.files.all.filter(idFilter([{min:parseInt(a),max:parseInt(a)}]))[0],n=stash.data[o].T||getApproxTime(a),i=getContributor(o),s=getCategory(o);if($(".contributor-name").text(i).attr("title",`Click to see all files by ${i}`).attr("href",toSearchURLParams({contributor:i})).on("click",t=>{goToPage(toSearchURLParams({contributor:i})),t.preventDefault()}),$(".profile-link").attr("href",toURLParams({profile:i})).on("click",t=>{goToPage(toURLParams({profile:i})),t.preventDefault()}),$(".file-id").text(a),$(".file-category").text(s).attr("title",`Click to see all files in ${s}`).attr("href",toSearchURLParams({category:s})).on("click",t=>{goToPage(toSearchURLParams({category:s})),t.preventDefault()}),$(".file-date").text(formatDate(n)),e)stash.page.hasWork=!0,stash.getZIPContent(o).then(t=>{const o=t.filter(t=>e==(t.path.length>0?t.path+"/":"")+t.name);if(0==o.length)return stash.workError(),void stash.notify("Failed to find file: "+e,null,"error");const n=o[0],i=getExt(n.name);$(".file-id").attr("title",`ZIP file containing ${n.name}`).attr("href",toURLParams({details:a})).on("click",t=>{goToPage(toURLParams({details:a})),t.preventDefault()}),$(".append-file-path").append(":"+(n.path.length>0?n.path+"/":"")+"<span>"+n.name.replace(/\.[^.]*$/,"")+"</span>."+i);const s=$("#texture-preview").addClass("file "+i).removeClass("x1").attr("data-filetype",i),r=E("div").addClass("overlay").appendTo(s);if("png"==i){s.append(E("div").addClass("img b-lazy").attr("data-src","data:image/png;base64,"+n.content)),stash.getImage("data:image/png;base64,"+n.content).then(t=>{$(".image-size").text(t.width+"x"+t.height)}),$(".png-only").show(),$(".zip-only").hide(),r.append(E("a").addClass("action-button download-image-button").attr("download",n.name).attr("title","Download").attr("href","data:image/png;base64,"+n.content).on("click",t=>{t.stopPropagation()})),r.append(E("div").addClass("action-button fullscreen-button").attr("title","Fullscreen").on("click",t=>{$("#fullscreen-cover").removeClass("hidden"),$("#fullscreen-cover .img").removeClass("b-loaded b-error").attr("style","").attr("data-src","data:image/png;base64,"+n.content),t.stopPropagation()}));const t=new Image;t.onload=(()=>{t.width<128&&t.height<128&&s.addClass("pixelated")}),t.src="data:image/png;base64,"+n.content}else $(".png-only,.zip-only").hide(),r.append(E("a").addClass("action-button download-image-button").attr("download",n.name).attr("title","Download").attr("href","data:text/plain;base64,"+btoa(n.content)).on("click",t=>{t.stopPropagation()}));tippy(r.find(".action-button").toArray(),{arrow:!0,animation:"perspective",performance:!0}),tippy("#content .info a",{placement:"right",arrow:!0,animation:"perspective"}),stash.workComplete()}).catch(t=>{stash.workError()});else{if(createFilePreview(o,$("#texture-preview")),o.match(/\.zip$/)){$(".zip-type").text(stash.typeNames[stash.data[o].Z]),$(".zip-only").show(),$(".png-only").hide(),stash.page.hasWork=!0;const t=()=>{$.getJSON(contentData+o.replace(/\.zip$/,".json"),t=>{const a=(t,e)=>{if("object"==typeof t){let o=E("div").addClass("info-dir");e?o.append(e):o.addClass("no-name");for(let e in t)t.hasOwnProperty(e)&&o.append(a(t[e],e));return o}return E("div").addClass("info-file").text(e).append(E("span").addClass("info-filesize").text(formatBytes(t)))};$("#zip-content-display").remove(),$("#package-info").append(a(t).attr("id","zip-content-display")),stash.workComplete()})};$("#package-info").append(E("h2").text("File content")).append(E("select").attr("id","zip-content-display-type").append(E("option").attr("value","tree").text("Tree view").prop("selected",!0)).append(E("option").attr("value","list").text("List view")).append(E("option").attr("value","tile").text("Tile view")).on("change",e=>{const n=$("#zip-content-display-type").val();stash.workIndeterminate(),"tree"==n?t():"list"==n?$.getJSON(contentData+o.replace(/\.zip$/,".json"),t=>{const a=(t,e,o)=>{for(let n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?a(t,e[n],o+n+"/"):t.append(E("div").addClass("info-file").text(o+n).append(E("span").addClass("info-filesize").text(formatBytes(e[n])))))},e=E("div").addClass("info-dir").addClass("no-name").attr("id","zip-content-display");a(e,t,""),$("#zip-content-display").remove(),$("#package-info").append(e),stash.workComplete()}):"tile"==n&&stash.getZIPContent(o).then(t=>{$("#zip-content-display").remove();const e=E("div").attr("id","zip-content-display").addClass("tile-view");t.forEach(t=>{const o=getExt(t.name),n=E("div").addClass("file "+o).attr("data-filetype",o).attr("title",`<h3>${t.name}</h3><p>Size: ${formatBytes(t.size)}</p>${t.path.length>0?`<br><i>${t.path}</i>`:""}`).on("click",()=>{goToPage(toURLParams({details:a+":"+(t.path.length>0?t.path+"/":"")+t.name}))}),i=E("div").addClass("overlay").appendTo(n);tippy(n[0],{arrow:!0,animation:"perspective",placement:"right"}),"png"==o?(n.append(E("div").addClass("img b-lazy").attr("data-src","data:image/png;base64,"+t.content)),i.append(E("a").addClass("action-button download-image-button").attr("download",t.name).attr("title","Download").attr("href","data:image/png;base64,"+t.content).on("click",t=>{t.stopPropagation()})),i.append(E("div").addClass("action-button fullscreen-button").attr("title","Fullscreen").on("click",a=>{$("#fullscreen-cover").removeClass("hidden"),$("#fullscreen-cover .img").removeClass("b-loaded b-error").attr("style","").attr("data-src","data:image/png;base64,"+t.content),a.stopPropagation()})),stash.getImage("data:image/png;base64,"+t.content).then(t=>{t.width<128&&t.height<128&&n.addClass("pixelated")})):i.append(E("a").addClass("action-button download-image-button").attr("download",t.name).attr("title","Download").attr("href","data:text/plain;base64,"+btoa(t.content)).on("click",t=>{t.stopPropagation()})),tippy(i.find(".action-button").toArray(),{arrow:!0,animation:"perspective",performance:!0}),e.append(n)}),$("#package-info").append(e),stash.workComplete()}).catch(t=>{stash.workError()})})),initSelectric(),t()}else $(".image-size").text(stash.data[o].S.join("x")),$(".png-only").show(),$(".zip-only").hide(),stash.data[o].M&&(stash.page.hasWork=!0,$.ajax(cors+stashURL+o+".mcmeta").done(t=>{$("#package-info").append(E("h2").text("MCMETA")).append(E("textarea").attr("spellcheck",!1).prop("readonly",!0).val(JSON.stringify(JSON.parse(t),null,2))),stash.workComplete()}).fail(t=>{stash.workError(),stash.notify(`Failed to load MCMETA. (${t.status} ${t.statusText})`,null,"error")}));tippy("#content .info a",{placement:"right",arrow:!0,animation:"perspective"});const t=stash.files.all.filter(contributorFilter(i)).sort(idSort),e=t.indexOf(o)+1,r=t.filter(categoryFilter(s)).indexOf(o)+1,l=stash.files.all.sort(idSort),p=l.indexOf(o)+1,d=l.filter(categoryFilter(s)).indexOf(o)+1,c=Math.floor((n-opTime)/86400);$("#misc-stats").append(E("p").text(`This is the ${formatNum(e,!0)} file ${i} posted and the ${formatNum(r,!0)} file by them in ${s}.`)).append(E("p").text(`It is the ${formatNum(p,!0)} file added to DokuStash and the ${formatNum(d,!0)} file added to ${s}.`)).append(E("p").text(`It was posted ${formatNum(c)} days after the continuation project started.`))}})();</script><style>#package-info .selectric-wrapper {
  width: 260px;
  margin-bottom: 16px;
}
#zip-content-display.tile-view {
  display: flex;
  flex-wrap: wrap;
}</style>