<h2>File details</h2><div class="block"><div class="file-preview no-action"></div><div class="sp-details-file-info"><p>Made by <a class="contributor-name"></a> (<a class="profile-link">Profile</a>)</p><p class="append-file-path">ID: <a class="file-id"></a></p><p class="png-only">Size: <span class="image-size"></span></p><p class="zip-only">Type: <span class="zip-type"></span></p><p>Date: <a class="file-date" title="Find files posted around the same time"></a></p><div class="tags"></div></div></div><div class="sp-details-button-row row"></div><div class="sp-details-misc-stats"></div><div class="sp-details-parents"></div><hr/><div class="sp-details-package-info"></div><link rel="stylesheet" href="/stash/pages/css/details.css"/><script>stash.page.hasWork=!0,stash.page.identifier().then(t=>{const a=getURLParams(t.attr("data-params")).details.split(":"),e=a[0],s=a[1],n=stash.nameOf(e);if(!n)return t.children(":not(script):not(link)").remove(),t.append(E("p").text("File not found.")),void stash.workComplete();const i=stash.data[n].contributor,o=stash.query.contributor(i);t.find(".contributor-name").text(i).attr("title",`Files by ${i}`).attr("href",toURLParams({search:o})).on("click",a=>{stash.page.modal(toURLParams({search:o}),t.closest(".stash-page-wrapper")),a.preventDefault()}),t.find(".profile-link").attr("href",toURLParams({profile:i})).on("click",a=>{stash.page.modal(toURLParams({profile:i}),t.closest(".stash-page-wrapper")),a.preventDefault()}),t.find(".file-id").text(e);const d=formatDate(new Date(stash.data[n].timestamp-604800)),p=formatDate(new Date(stash.data[n].timestamp+604800));if(t.find(".file-date").text(formatDate(stash.data[n].timestamp)).attr("href",toURLParams({search:`>{${d}} <{${p}}`})).on("click",a=>{stash.page.modal(toURLParams({search:`>{${d}} <{${p}}`}),t.closest(".stash-page-wrapper")),a.preventDefault()}),s)stash.getZIPContent(n).then(n=>{const i=n.filter(t=>s==(t.path.length>0?t.path+"/":"")+t.name);if(0==i.length)return stash.workError(),void stash.notify("Failed to find file: "+s,null,"error");const o=i[0],d=getExt(o.name);t.find(".sp-details-file-info .file-id").attr("title",`ZIP file containing ${o.name}`).attr("href",toURLParams({details:e})).on("click",t=>{stash.page.load(toURLParams({details:e})),t.preventDefault()}),t.find(".sp-details-file-info .append-file-path").append(":"+(o.path.length>0?o.path+"/":"")+"<span>"+o.name.replace(/\.[^.]*$/,"")+"</span>."+d);const p=t.find(".file-preview").addClass("file ext "+d).attr("data-filetype",d),l=E("div").addClass("overlay").appendTo(p);if("png"==d){p.append(E("div").addClass("img b-lazy").attr("data-src","data:image/png;base64,"+o.content)),stash.getImage("data:image/png;base64,"+o.content).then(e=>{t.find(".image-size").text(e.width+"x"+e.height);const i=s+".mcmeta";(n.find(t=>i==(t.path.length>0?t.path+"/":"")+t.name)||e.height/e.width>=6&&e.height%e.width==0)&&t.find(".sp-details-button-row").append(stash.anchor({"animation-editor":"id:"+a.join(":")}).addClass("inline button").text("Open in Animation Editor"))}),t.find(".sp-details-file-info .png-only").show(),t.find(".sp-details-file-info .zip-only").hide(),l.append(E("a").addClass("action-button download-image-button").attr("download",o.name).attr("title","Download").attr("href","data:image/png;base64,"+o.content).on("click",t=>{t.stopPropagation()})),l.append(E("div").addClass("action-button fullscreen-button").attr("title","Fullscreen").on("click",t=>{stash.fullscreenImage("data:image/png;base64,"+o.content),t.stopPropagation()}));const e=new Image;e.onload=(()=>{e.width<128&&e.height<128&&p.addClass("pixelated")}),e.src="data:image/png;base64,"+o.content}else t.find(".png-only,.zip-only").hide(),t.find(".sp-details-package-info").append(E("h2").text("File content"),E("textarea").prop("readonly",!0).val(o.content)),l.append(E("a").addClass("action-button download-image-button").attr("download",o.name).attr("title","Download").attr("href","data:text/plain;base64,"+btoa(o.content)).on("click",t=>{t.stopPropagation()}));tippy(l.find(".action-button").toArray()),tippy(t.find(".info a").toArray(),{placement:"right"}),stash.workComplete()}).catch(t=>{stash.workError(),stash.notify("Failed to load ZIP file: "+t,null,"error")});else{if(t.find(".tags").replaceWith(stash.tags.element(n)),createFilePreview(n,t.find(".file-preview")),stash.data[n].parents&&t.find(".sp-details-parents").append(E("h3").text("Derived from:"),E("div").addClass("sp-details-files-container").append(stash.data[n].parents.map(a=>{const e=stash.nameOf(a);if(null==e)return"";const s=createFilePreview(e,E("a").attr("href",toURLParams({details:a})));s.on("click",e=>{stash.page.modal(toURLParams({details:a}),t.closest(".stash-page-wrapper")),e.preventDefault()});const n=stash.data[e].size,i=E("div").append(E("h3").text(`${stash.data[e].contributor} #${stash.data[e].id}`));return stash.data[e].packageType?i.append(E("div").addClass("row").html($("#package-icon").html()+` ${stash.typeNames[stash.data[e].packageType]}`)):(i.append(E("div").addClass("row").html($("#aspect-ratio-icon").html()+` ${n[0]}x${n[1]}`)),stash.data[e].mcmeta&&i.append(E("div").addClass("row").html($("#code-icon").html()+" Custom MCMETA file"))),i.append(E("p").append(E("div").addClass("row").html($("#calendar-icon").html()+" "+formatDate(stash.data[e].timestamp))),stash.tags.element(e).addClass("compact").css("margin-top","12px")),s.attr("title",i[0].innerHTML),tippy(s[0],{placement:"right"}),s}))),"zip"==stash.data[n].ext){t.find(".zip-type").text(stash.typeNames[stash.data[n].packageType]),t.find(".sp-details-file-info .zip-only").show(),t.find(".sp-details-file-info .png-only").hide();const a=()=>{stash.getZIPContent(n).then(a=>{t.find(".zip-content-display").remove();const s=E("div").addClass("zip-content-display tile-view");a.sort((t,a)=>naturalSorter((t.path.length>0?t.path+"/":"")+t.name,(a.path.length>0?a.path+"/":"")+a.name)).forEach(a=>{const n=getExt(a.name),i=E("div").addClass("file ext "+n).attr("data-filetype",n).attr("title",`<h3>${a.name}</h3><p>Size: ${formatBytes(a.size)}</p>${a.path.length>0?`<br><p><sub class="faded">${a.path}</sub></p>`:""}`).on("click",()=>{stash.page.modal(toURLParams({details:e+":"+(a.path.length>0?a.path+"/":"")+a.name}),t.closest(".stash-page-wrapper"))}),o=E("div").addClass("overlay").appendTo(i);tippy(i[0],{placement:"right"}),"png"==n?(i.append(E("div").addClass("img b-lazy").attr("data-src","data:image/png;base64,"+a.content)),o.append(E("a").addClass("action-button download-image-button").attr("download",a.name).attr("title","Download").attr("href","data:image/png;base64,"+a.content).on("click",t=>{t.stopPropagation()})),o.append(E("div").addClass("action-button fullscreen-button").attr("title","Fullscreen").on("click",t=>{stash.fullscreenImage("data:image/png;base64,"+a.content),t.stopPropagation()})),stash.getImage("data:image/png;base64,"+a.content).then(t=>{t.width<128&&t.height<128&&i.addClass("pixelated")})):o.append(E("a").addClass("action-button download-image-button").attr("download",a.name).attr("title","Download").attr("href",URL.createObjectURL(new Blob([a.content],{type:"text/plain"}))).on("click",t=>{t.stopPropagation()})),tippy(o.find(".action-button").toArray()),s.append(i)}),t.find(".sp-details-package-info").append(s),stash.workComplete()}).catch(t=>{console.error(t),stash.workError()})};t.find(".sp-details-package-info").append(E("div").addClass("row").append(E("h2").text("File content"),E("div").addClass("zip-content-display-type").css({width:"260px","margin-left":"12px"}).on("change",s=>{const i=t.find(".zip-content-display-type")[0].val();stash.workIndeterminate(),"tree"==i?stash.getZIPContent(n).then(a=>{t.find(".zip-content-display").remove();const s=E("div").addClass("zip-content-display info-dir no-name"),n={};a.sort((t,a)=>naturalSorter((t.path.length>0?t.path+"/":"")+t.name,(a.path.length>0?a.path+"/":"")+a.name)).forEach(t=>{let a=n;t.path.split("/").forEach(t=>{a[t]=a[t]||{},a=a[t]}),a[t.name]=t});const i=(a,s)=>{Object.keys(s).forEach(n=>{"number"==typeof s[n].size?a.append(E("div").addClass("info-file").text(s[n].name).append(E("span").addClass("info-filesize").text(formatBytes(s[n].size))).on("click",()=>{stash.page.modal(toURLParams({details:e+":"+(s[n].path.length>0?s[n].path+"/":"")+s[n].name}),t.closest(".stash-page-wrapper"))})):i(n.length?E("div").addClass("info-dir").text(n).appendTo(a):a,s[n])})};i(s,n),t.find(".sp-details-package-info").append(s),stash.workComplete()}):"list"==i?stash.getZIPContent(n).then(a=>{t.find(".zip-content-display").remove();const s=E("div").addClass("zip-content-display info-dir no-name");a.sort((t,a)=>naturalSorter((t.path.length>0?t.path+"/":"")+t.name,(a.path.length>0?a.path+"/":"")+a.name)).forEach(a=>{s.append(E("div").addClass("info-file").text((a.path.length>0?a.path+"/":"")+a.name).append(E("span").addClass("info-filesize").text(formatBytes(a.size))).on("click",()=>{stash.page.modal(toURLParams({details:e+":"+(a.path.length>0?a.path+"/":"")+a.name}),t.closest(".stash-page-wrapper"))}))}),t.find(".sp-details-package-info").append(s),stash.workComplete()}):"tile"==i&&a()}))),CCInput(t.find(".zip-content-display-type"),{type:"select",lists:[{name:"Display Options",list:[{name:"Tile view",value:"tile",selected:!0},{name:"Tree view",value:"tree"},{name:"List view",value:"list"}]}]}),a()}else t.find(".sp-details-file-info .image-size").text(stash.data[n].size.join("x")),t.find(".sp-details-file-info .png-only").show(),t.find(".sp-details-file-info .zip-only").hide(),stash.query.match("animated",n)&&t.find(".sp-details-button-row").append(stash.anchor({"animation-editor":"id:"+stash.data[n].id}).addClass("inline button").text("Open in Animation Editor")),stash.data[n].mcmeta?$.ajax(stash.url.files+n+".mcmeta").done(a=>{t.find(".sp-details-package-info").append(E("h2").text("MCMETA"),E("textarea").attr("spellcheck",!1).prop("readonly",!0).val(JSON.stringify(JSON.parse(a),null,2))),stash.workComplete()}).fail(t=>{stash.workError(),stash.notify(`Failed to load MCMETA. (${t.status} ${t.statusText})`,null,"error")}):stash.workComplete();tippy(t.find(".sp-details-file-info a").toArray(),{placement:"right"});const a=stash.search(stash.query.contributor(i)).sort(idSort).indexOf(n)+1,s=stash.files.sort(idSort).indexOf(n)+1,o=Math.floor((stash.data[n].timestamp-opTime)/86400);t.find(".sp-details-misc-stats").append(E("p").text(`This is the ${formatNum(a,!0)} file by ${i} and the ${formatNum(s,!0)} file added to DokuStash.`),E("p").text(`It was posted ${formatNum(o)} days after the continuation project started.`))}});</script><img onload="stash.page.identifierLoaded(this);void(0);" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="/>