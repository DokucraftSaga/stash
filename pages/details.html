<div class="fill"><h2>File details</h2><div class="block"><div class="no-action x1" id="texture-preview"></div><div class="info"><p>Made by <a class="contributor-name"></a> (<a class="profile-link">Profile</a>)</p><p class="append-file-path">ID: <a class="file-id"></a></p><p>Category: <a class="file-category"></a></p><p class="png-only">Size: <span class="image-size"></span></p><p class="zip-only">Type: <span class="zip-type"></span></p><p>Date: <span class="file-date"></span></p></div></div><div id="misc-stats"></div><br/><div id="package-info"></div></div><script>(()=>{const t=getURLParams().details.split(":"),e=t[0],a=t[1],o=stash.files.all.filter(idFilter([{min:parseInt(e),max:parseInt(e)}]))[0],n=stash.data[o].T||getApproxTime(e),i=getContributor(o),r=getCategory(o);if($(".contributor-name").text(i).attr("title",`Click to see all files by ${i}`).attr("href",toSearchURLParams({contributor:i})).on("click",t=>{goToPage(toSearchURLParams({contributor:i})),t.preventDefault()}),$(".profile-link").attr("href",toURLParams({profile:i})).on("click",t=>{goToPage(toURLParams({profile:i})),t.preventDefault()}),$(".file-id").text(e),$(".file-category").text(r).attr("title",`Click to see all files in ${r}`).attr("href",toSearchURLParams({category:r})).on("click",t=>{goToPage(toSearchURLParams({category:r})),t.preventDefault()}),$(".file-date").text(formatDate(n)),a)stash.page.hasWork=!0,stash.getZIPContent(o,(t,o)=>{if(o)return void stash.workError();const n=t.filter(t=>a==t.path+"/"+t.name);if(0==n.length)return stash.workError(),void stash.notify("Failed to find file: "+a,null,"error");const i=n[0],r=/\.([^.]*)$/.exec(i.name)[1].toLowerCase();$(".file-id").attr("title",`ZIP file containing ${i.name}`).attr("href",toURLParams({details:e})).on("click",t=>{goToPage(toURLParams({details:e})),t.preventDefault()}),$(".append-file-path").append(":"+i.path+"/<span>"+i.name.replace(/\.[^.]*$/,"")+"</span>."+r);const s=$("#texture-preview").addClass("file "+r).removeClass("x1").attr("data-filetype",r),l=E("div").addClass("overlay").appendTo(s);if("png"==r){s.append(E("div").addClass("img b-lazy").attr("data-src","data:image/png;base64,"+i.content)),stash.getImage("data:image/png;base64,"+i.content,t=>{$(".image-size").text(t.width+"x"+t.height)}),$(".png-only").show(),$(".zip-only").hide(),l.append(E("a").addClass("action-button download-image-button").attr("download",i.name).attr("title","Download").attr("href","data:image/png;base64,"+i.content).on("click",t=>{t.stopPropagation()})),l.append(E("div").addClass("action-button fullscreen-button").attr("title","Fullscreen").on("click",t=>{$("#fullscreen-cover").removeClass("hidden"),$("#fullscreen-cover .img").removeClass("b-loaded b-error").attr("style","").attr("data-src","data:image/png;base64,"+i.content),t.stopPropagation()}));const t=new Image;t.onload=(()=>{t.width<128&&t.height<128&&s.addClass("pixelated")}),t.src="data:image/png;base64,"+i.content}else $(".png-only,.zip-only").hide(),l.append(E("a").addClass("action-button download-image-button").attr("download",i.name).attr("title","Download").attr("href","data:text/plain;base64,"+btoa(i.content)).on("click",t=>{t.stopPropagation()}));tippy(l.find(".action-button").toArray(),{arrow:!0,animation:"perspective",performance:!0}),tippy("#content .info a",{placement:"right",arrow:!0,animation:"perspective"}),stash.workComplete()});else{if(createFilePreview(o,$("#texture-preview")),o.match(/\.zip$/)){$(".zip-type").text(stash.typeNames[stash.data[o].Z]),$(".zip-only").show(),$(".png-only").hide(),stash.page.hasWork=!0;const t=()=>{$.getJSON(contentData+o.replace(/\.zip$/,".json"),t=>{const e=(t,a)=>{if("object"==typeof t){let o=E("div").addClass("info-dir");a?o.append(a):o.addClass("no-name");for(let a in t)t.hasOwnProperty(a)&&o.append(e(t[a],a));return o}return E("div").addClass("info-file").text(a).append(E("span").addClass("info-filesize").text(formatBytes(t)))};$("#zip-content-display").remove(),$("#package-info").append(e(t).attr("id","zip-content-display")),stash.workComplete()})};$("#package-info").append(E("h2").text("File content")).append(E("select").attr("id","zip-content-display-type").append(E("option").attr("value","tree").text("Tree view").prop("selected",!0)).append(E("option").attr("value","list").text("List view")).append(E("option").attr("value","tile").text("Tile view")).on("change",a=>{const n=$("#zip-content-display-type").val();stash.workIndeterminate(),"tree"==n?t():"list"==n?$.getJSON(contentData+o.replace(/\.zip$/,".json"),t=>{const e=(t,a,o)=>{for(let n in a)a.hasOwnProperty(n)&&("object"==typeof a[n]?e(t,a[n],o+n+"/"):t.append(E("div").addClass("info-file").text(o+n).append(E("span").addClass("info-filesize").text(formatBytes(a[n])))))},a=E("div").addClass("info-dir").addClass("no-name").attr("id","zip-content-display");e(a,t,""),$("#zip-content-display").remove(),$("#package-info").append(a),stash.workComplete()}):"tile"==n&&stash.getZIPContent(o,(t,a)=>{if(a)return void stash.workError();$("#zip-content-display").remove();const o=E("div").attr("id","zip-content-display").addClass("tile-view");t.forEach(t=>{const a=/\.([^.]*)$/.exec(t.name)[1].toLowerCase(),n=E("div").addClass("file "+a).attr("data-filetype",a).attr("title",`<h3>${t.name}</h3><p>Size: ${formatBytes(t.size)}</p>${t.path.length>0?`<br><i>${t.path}</i>`:""}`).on("click",()=>{goToPage(toURLParams({details:e+":"+t.path+"/"+t.name}))}),i=E("div").addClass("overlay").appendTo(n);tippy(n[0],{arrow:!0,animation:"perspective",placement:"right"}),"png"==a?(n.append(E("div").addClass("img b-lazy").attr("data-src","data:image/png;base64,"+t.content)),i.append(E("a").addClass("action-button download-image-button").attr("download",t.name).attr("title","Download").attr("href","data:image/png;base64,"+t.content).on("click",t=>{t.stopPropagation()})),i.append(E("div").addClass("action-button fullscreen-button").attr("title","Fullscreen").on("click",e=>{$("#fullscreen-cover").removeClass("hidden"),$("#fullscreen-cover .img").removeClass("b-loaded b-error").attr("style","").attr("data-src","data:image/png;base64,"+t.content),e.stopPropagation()})),stash.getImage("data:image/png;base64,"+t.content,t=>{t.width<128&&t.height<128&&n.addClass("pixelated")})):i.append(E("a").addClass("action-button download-image-button").attr("download",t.name).attr("title","Download").attr("href","data:text/plain;base64,"+btoa(t.content)).on("click",t=>{t.stopPropagation()})),tippy(i.find(".action-button").toArray(),{arrow:!0,animation:"perspective",performance:!0}),o.append(n)}),$("#package-info").append(o),stash.workComplete()})})),initSelectric(),t()}else $(".image-size").text(stash.data[o].S.join("x")),$(".png-only").show(),$(".zip-only").hide(),stash.data[o].M&&(stash.page.hasWork=!0,$.ajax(cors+stashURL+o+".mcmeta").done(t=>{$("#package-info").append(E("h2").text("MCMETA")).append(E("textarea").attr("spellcheck",!1).prop("readonly",!0).val(JSON.stringify(JSON.parse(t),null,2))),stash.workComplete()}).fail(t=>{stash.workError(),stash.notify(`Failed to load MCMETA. (${t.status} ${t.statusText})`,null,"error")}));tippy("#content .info a",{placement:"right",arrow:!0,animation:"perspective"});const t=stash.files.all.filter(contributorFilter(i)).sort(idSort),a=t.indexOf(o)+1,s=t.filter(categoryFilter(r)).indexOf(o)+1,l=stash.files.all.sort(idSort),p=l.indexOf(o)+1,d=l.filter(categoryFilter(r)).indexOf(o)+1,c=Math.floor((n-opTime)/86400);$("#misc-stats").append(E("p").text(`This is the ${formatNum(a,!0)} file ${i} posted and the ${formatNum(s,!0)} file by them in ${r}.`)).append(E("p").text(`It is the ${formatNum(p,!0)} file added to DokuStash and the ${formatNum(d,!0)} file added to ${r}.`)).append(E("p").text(`It was posted ${formatNum(c)} days after the continuation project started.`))}})();</script><style>#package-info .selectric-wrapper {
  width: 260px;
  margin-bottom: 16px;
}
#zip-content-display.tile-view {
  display: flex;
  flex-wrap: wrap;
}</style>